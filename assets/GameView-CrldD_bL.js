import{d as B,l as I,r as D,c as g,o as H,m as O,a as l,b as e,e as m,t as s,n as b,j as r,w as M,f as p,F as j,h as E,u as F,i as G,p as R}from"./index-Btk_ZN5t.js";const V={class:"card"},z={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6"},q={class:"flex-shrink-0"},J=["src","alt"],U={class:"flex-1 text-center md:text-left"},K={key:0,class:"mb-4"},Q={class:"text-gray-600"},W={class:"text-sm text-gray-500"},X={key:1,class:"mb-4"},Y={class:"text-xl font-bold text-gray-800"},Z={class:"text-lg text-gray-600"},ee={class:"text-sm text-gray-500"},te={key:2,class:"mb-4"},se={class:"text-xl font-bold text-gray-800"},ae={class:"text-lg text-gray-600"},ne={class:"text-gray-600"},re={class:"text-sm text-gray-500"},le={class:"mb-4"},oe=["src"],ie={class:"flex items-center justify-center md:justify-start space-x-4 mb-4"},ce=["disabled"],de={key:0},ue={key:1},me=["disabled"],ge={key:3,class:"p-4 bg-blue-50 border border-blue-200 rounded-lg"},pe={class:"text-center"},ve={class:"text-lg font-bold text-blue-800"},he={class:"text-blue-700"},ye={class:"text-blue-600"},fe={class:"text-sm text-blue-500 mt-2"},$e=["href"],_e={key:0,class:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg"},be={class:"text-center font-medium text-yellow-800"},ke={class:"text-center text-sm text-yellow-700 mt-1"},xe={class:"font-bold text-lg"},we={key:0,class:"text-sm mt-1"},Te=B({__name:"TrackPlayer",props:{track:{},difficulty:{},showAnswer:{type:Boolean,default:!1},showResult:{type:Boolean,default:!1},isCorrect:{type:Boolean,default:!1},pointsEarned:{default:0}},emits:["placeTrack"],setup(C,{emit:x}){const o=C,{t:y}=I(),d=D(),i=D(!1),v=g(()=>{var t,n,a,c;return((n=(t=o.track.images)==null?void 0:t[0])==null?void 0:n.url)||((c=(a=o.track.album.images)==null?void 0:a[0])==null?void 0:c.url)||"/placeholder-album.png"}),h=g(()=>o.track.artists.map(t=>t.name).join(", ")),w=g(()=>o.showResult?o.isCorrect?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800":""),T=g(()=>o.showResult?o.isCorrect?y("game.turn.correct",{year:o.track.year}):y("game.turn.incorrect",{year:o.track.year}):"");function k(){d.value&&(i.value?d.value.pause():d.value.play())}function f(){d.value&&(d.value.currentTime=0,i.value&&d.value.play())}function P(){i.value=!1}return H(()=>{d.value&&(d.value.addEventListener("play",()=>{i.value=!0}),d.value.addEventListener("pause",()=>{i.value=!1}))}),O(()=>{d.value&&d.value.pause()}),(t,n)=>(r(),l("div",V,[e("div",z,[e("div",q,[e("img",{src:v.value,alt:t.track.name,class:"w-32 h-32 rounded-lg shadow-lg object-cover"},null,8,J)]),e("div",U,[t.difficulty==="original"?(r(),l("div",K,[e("p",Q,s(t.$t("game.turn.listening")),1),e("p",W,s(t.$t("game.difficulties.originalHint")),1)])):t.difficulty==="pro"?(r(),l("div",X,[e("h3",Y,s(t.track.name),1),e("p",Z,s(h.value),1),e("p",ee,s(t.$t("game.difficulties.proHint")),1)])):t.difficulty==="expert"?(r(),l("div",te,[e("h3",se,s(t.track.name),1),e("p",ae,s(h.value),1),e("p",ne,s(t.track.album.name),1),e("p",re,s(t.$t("game.difficulties.expertHint")),1)])):m("",!0),e("div",le,[e("audio",{ref_key:"audioPlayer",ref:d,src:t.track.preview_url||void 0,controls:"",class:"w-full",onEnded:P},s(t.$t("game.audioNotSupported")),41,oe)]),e("div",ie,[e("button",{onClick:k,class:"btn btn-primary",disabled:!t.track.preview_url},[i.value?(r(),l("span",de,"⏸️ "+s(t.$t("game.pause")),1)):(r(),l("span",ue,"▶️ "+s(t.$t("game.play")),1))],8,ce),e("button",{onClick:f,class:"btn btn-secondary",disabled:!t.track.preview_url}," 🔄 "+s(t.$t("game.restart")),9,me)]),t.showAnswer?(r(),l("div",ge,[e("div",pe,[e("h4",ve,s(t.track.name),1),e("p",he,s(h.value),1),e("p",ye,s(t.track.album.name)+" ("+s(t.track.year)+")",1),e("p",fe,[e("a",{href:t.track.external_urls.spotify,target:"_blank",rel:"noopener noreferrer",class:"underline hover:no-underline"},s(t.$t("game.openInSpotify"))+" ↗ ",9,$e)])])])):m("",!0)])]),t.showAnswer?m("",!0):(r(),l("div",_e,[e("p",be,s(t.$t("game.turn.placing")),1),e("p",ke,s(t.$t("game.dragToTimeline")),1)])),t.showResult?(r(),l("div",{key:1,class:b(["mt-4 p-4 rounded-lg text-center",w.value])},[e("p",xe,s(T.value),1),t.pointsEarned>0?(r(),l("p",we,s(t.$t("game.turn.points",{points:t.pointsEarned})),1)):m("",!0)],2)):m("",!0)]))}}),Pe={class:"flex items-center justify-between mb-4"},De={class:"text-lg font-semibold flex items-center space-x-2"},Ce={key:0,class:"text-green-500"},je={class:"text-right"},Ee={class:"text-2xl font-bold"},Be={class:"text-sm text-gray-600"},Se={class:"mb-4"},Ne={class:"text-sm font-medium text-gray-700 mb-2"},Ae={key:0,class:"text-center py-8 text-gray-500"},Le={class:"text-center text-gray-500"},Re={key:1,class:"space-y-2"},He={class:"text-center text-gray-500 text-sm"},Ie={class:"flex items-center space-x-3"},Oe=["src","alt"],Me={class:"flex-1 min-w-0"},Fe={class:"font-medium truncate"},Ge={class:"text-sm text-gray-600 truncate"},Ve={class:"text-right flex-shrink-0"},ze={class:"font-bold text-lg"},qe=["onDragover","onDragleave","onDrop"],Je={class:"text-center text-gray-500 text-sm"},Ue={class:"text-center text-gray-500 text-sm"},Ke={class:"flex items-center space-x-3"},Qe=["src","alt"],We={class:"flex-1 min-w-0"},Xe={class:"font-medium text-blue-800"},Ye={class:"text-sm text-blue-600"},Ze={key:1,class:"mt-4 pt-4 border-t border-gray-200"},et={class:"flex justify-between text-sm text-gray-600"},tt={key:0},st=B({__name:"PlayerTimeline",props:{player:{},isCurrent:{type:Boolean},currentTrack:{},canPlace:{type:Boolean}},emits:["placeTrack"],setup(C,{emit:x}){const o=C,y=x,d=D(!1),i=D([]),v=g(()=>{if(o.player.timeline.length<2)return null;const t=o.player.timeline.map(n=>n.year).sort((n,a)=>n-a);return`${t[0]} - ${t[t.length-1]}`});function h(t){var n,a,c,$;return((a=(n=t.images)==null?void 0:n[0])==null?void 0:a.url)||(($=(c=t.album.images)==null?void 0:c[0])==null?void 0:$.url)||"/placeholder-album.png"}function w(t){return t.artists.map(n=>n.name).join(", ")}function T(t){var a;if(!o.currentTrack)return;(a=t.dataTransfer)==null||a.setData("text/plain",JSON.stringify(o.currentTrack)),t.target.classList.add("dragging")}function k(t){t.target.classList.remove("dragging"),d.value=!1,i.value=[]}function f(t){!o.currentTrack||!o.canPlace||(d.value=!1,i.value=[],y("placeTrack",o.currentTrack,t))}function P(){i.value=new Array(o.player.timeline.length+1).fill(!1)}return M(()=>o.player.timeline.length,()=>{P()},{immediate:!0}),(t,n)=>(r(),l("div",{class:b(["card",{"ring-2 ring-green-500":t.isCurrent}])},[e("div",Pe,[e("h3",De,[e("span",null,s(t.player.name),1),t.isCurrent?(r(),l("span",Ce,"👑")):m("",!0)]),e("div",je,[e("p",Ee,s(t.player.score),1),e("p",Be,s(t.$t("game.score.tokens",{count:t.player.tokens})),1)])]),e("div",Se,[e("h4",Ne,s(t.$t("game.timeline.title")),1),t.player.timeline.length===0?(r(),l("div",Ae,[e("p",null,s(t.$t("game.timeline.empty")),1),t.canPlace?(r(),l("div",{key:0,class:b(["timeline-slot mt-4",{"drag-over":d.value}]),onDragover:n[0]||(n[0]=p(a=>d.value=!0,["prevent"])),onDragleave:n[1]||(n[1]=p(a=>d.value=!1,["prevent"])),onDrop:n[2]||(n[2]=p(a=>f(0),["prevent"]))},[e("p",Le,s(t.$t("game.timeline.placeHere")),1)],34)):m("",!0)])):(r(),l("div",Re,[t.canPlace?(r(),l("div",{key:0,class:b(["timeline-slot h-16",{"drag-over":i.value[0]}]),onDragover:n[3]||(n[3]=p(a=>i.value[0]=!0,["prevent"])),onDragleave:n[4]||(n[4]=p(a=>i.value[0]=!1,["prevent"])),onDrop:n[5]||(n[5]=p(a=>f(0),["prevent"]))},[e("p",He,s(t.$t("game.placeEarlier")),1)],34)):m("",!0),(r(!0),l(j,null,E(t.player.timeline,(a,c)=>(r(),l("div",{key:a.id,class:"track-card"},[e("div",Ie,[e("img",{src:h(a),alt:a.name,class:"w-12 h-12 rounded object-cover flex-shrink-0"},null,8,Oe),e("div",Me,[e("p",Fe,s(a.name),1),e("p",Ge,s(w(a)),1)]),e("div",Ve,[e("p",ze,s(a.year),1)])]),t.canPlace&&c<t.player.timeline.length-1?(r(),l("div",{key:0,class:b(["timeline-slot h-16 mt-2",{"drag-over":i.value[c+1]}]),onDragover:p($=>i.value[c+1]=!0,["prevent"]),onDragleave:p($=>i.value[c+1]=!1,["prevent"]),onDrop:p($=>f(c+1),["prevent"])},[e("p",Je,s(t.$t("game.placeBetween")),1)],42,qe)):m("",!0)]))),128)),t.canPlace?(r(),l("div",{key:1,class:b(["timeline-slot h-16",{"drag-over":i.value[t.player.timeline.length]}]),onDragover:n[6]||(n[6]=p(a=>i.value[t.player.timeline.length]=!0,["prevent"])),onDragleave:n[7]||(n[7]=p(a=>i.value[t.player.timeline.length]=!1,["prevent"])),onDrop:n[8]||(n[8]=p(a=>f(t.player.timeline.length),["prevent"]))},[e("p",Ue,s(t.$t("game.placeLater")),1)],34)):m("",!0)]))]),t.canPlace&&t.currentTrack?(r(),l("div",{key:0,class:"p-4 bg-blue-50 border-2 border-blue-200 rounded-lg cursor-move",draggable:"true",onDragstart:T,onDragend:k},[e("div",Ke,[e("img",{src:h(t.currentTrack),alt:t.currentTrack.name,class:"w-12 h-12 rounded object-cover flex-shrink-0"},null,8,Qe),e("div",We,[e("p",Xe,s(t.$t("game.newTrack")),1),e("p",Ye,s(t.$t("game.dragToPlace")),1)]),n[9]||(n[9]=e("div",{class:"text-blue-500"},[e("span",{class:"text-2xl"},"🎵")],-1))])],32)):m("",!0),t.player.timeline.length>0?(r(),l("div",Ze,[e("div",et,[e("span",null,s(t.$t("game.tracksInTimeline",{count:t.player.timeline.length})),1),v.value?(r(),l("span",tt,s(v.value),1)):m("",!0)])])):m("",!0)],2))}}),at={class:"min-h-screen flex flex-col"},nt={class:"bg-white/10 backdrop-blur-sm p-4"},rt={class:"flex justify-between items-center"},lt={class:"flex items-center space-x-4"},ot={class:"text-white"},it={class:"text-xl font-bold"},ct={class:"text-sm opacity-80"},dt={class:"text-white text-right"},ut={class:"text-sm opacity-80"},mt={class:"flex-1 container mx-auto px-4 py-6"},gt={key:0,class:"max-w-2xl mx-auto"},pt={class:"card text-center"},vt={class:"text-2xl font-semibold mb-4"},ht={class:"text-gray-600 mb-6"},yt={key:1,class:"space-y-6"},ft={class:"card text-center bg-green-50 border-green-200"},$t={class:"text-2xl font-bold text-green-800 mb-2"},_t={class:"text-green-700"},bt={key:0,class:"mt-4"},kt={key:1,class:"mt-4"},xt={class:"flex items-center justify-center space-x-2"},wt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Tt={class:"card"},Pt={class:"text-lg font-semibold mb-4"},Dt={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Ct={class:"font-semibold"},jt={class:"text-2xl font-bold"},Et={class:"text-sm text-gray-600"},Bt={key:2,class:"max-w-2xl mx-auto"},St={class:"card text-center"},Nt={class:"text-3xl font-bold mb-4 text-green-600"},At={class:"text-xl mb-6"},Lt={class:"mb-6"},Rt={class:"text-lg font-semibold mb-3"},Ht={class:"space-y-2"},It={class:"font-medium"},Ot={class:"font-bold"},Mt={class:"flex space-x-4 justify-center"},Gt=B({__name:"GameView",setup(C){const x=G(),o=F(),y=D(!1),d=g(()=>o.players),i=g(()=>o.currentPlayer),v=g(()=>o.currentTrack),h=g(()=>o.gamePhase),w=g(()=>o.round),T=g(()=>o.settings),k=g(()=>o.winner),f=g(()=>[...d.value].sort((a,c)=>c.score-a.score));async function P(){y.value=!0;try{await o.getNextTrack()||console.error("No tracks available")}catch(a){console.error("Error loading track:",a)}finally{y.value=!1}}function t(a,c){o.placeTrackOnTimeline(a,c),setTimeout(()=>{o.nextPlayer()},2e3)}function n(){o.resetGame(),x.push("/")}return H(()=>{o.gamePhase==="setup"&&o.players.length===0&&x.push("/")}),(a,c)=>{var $,S,N,A;return r(),l("div",at,[e("header",nt,[e("div",rt,[e("div",lt,[e("button",{onClick:c[0]||(c[0]=u=>a.$router.push("/")),class:"btn btn-secondary"}," ← "+s(a.$t("common.back")),1),e("div",ot,[e("h1",it,s(a.$t("game.title")),1),e("p",ct,s(a.$t("game.round"))+" "+s(w.value),1)])]),e("div",dt,[e("p",ut,s(a.$t("game.turn.currentPlayer",{player:($=i.value)==null?void 0:$.name})),1)])])]),e("main",mt,[h.value==="setup"?(r(),l("div",gt,[e("div",pt,[e("h2",vt,s(a.$t("game.setupRequired")),1),e("p",ht,s(a.$t("game.setupMessage")),1),e("button",{onClick:c[1]||(c[1]=u=>a.$router.push("/")),class:"btn btn-primary"},s(a.$t("game.backToSetup")),1)])])):h.value==="playing"?(r(),l("div",yt,[e("div",ft,[e("h2",$t,s(a.$t("game.turn.currentPlayer",{player:(S=i.value)==null?void 0:S.name})),1),e("p",_t,s(a.$t("game.turn.ready")),1),!v.value&&!y.value?(r(),l("div",bt,[e("button",{onClick:P,class:"btn btn-primary btn-lg"}," 🎵 "+s(a.$t("game.getTrack")),1)])):m("",!0),y.value?(r(),l("div",kt,[e("div",xt,[c[3]||(c[3]=e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-green-500"},null,-1)),e("span",null,s(a.$t("common.loading")),1)])])):m("",!0)]),v.value?(r(),R(Te,{key:0,track:v.value,difficulty:T.value.difficulty,onPlaceTrack:t},null,8,["track","difficulty"])):m("",!0),e("div",wt,[(r(!0),l(j,null,E(d.value,u=>{var _,L;return r(),R(st,{key:u.id,player:u,"is-current":u.id===((_=i.value)==null?void 0:_.id),"current-track":v.value,"can-place":u.id===((L=i.value)==null?void 0:L.id)&&!!v.value,onPlaceTrack:t},null,8,["player","is-current","current-track","can-place"])}),128))]),e("div",Tt,[e("h3",Pt,s(a.$t("game.score.title")),1),e("div",Dt,[(r(!0),l(j,null,E(d.value,u=>{var _;return r(),l("div",{key:u.id,class:b(["text-center p-3 rounded-lg",u.id===((_=i.value)==null?void 0:_.id)?"bg-green-100":"bg-gray-50"])},[e("p",Ct,s(u.name),1),e("p",jt,s(u.score),1),e("p",Et,s(a.$t("game.score.tokens",{count:u.tokens})),1)],2)}),128))])])])):h.value==="finished"?(r(),l("div",Bt,[e("div",St,[e("h2",Nt,s(a.$t("game.end.title")),1),e("p",At,s(a.$t("game.end.winner",{player:(N=k.value)==null?void 0:N.name,score:(A=k.value)==null?void 0:A.score})),1),e("div",Lt,[e("h3",Rt,s(a.$t("game.end.finalScores")),1),e("div",Ht,[(r(!0),l(j,null,E(f.value,(u,_)=>(r(),l("div",{key:u.id,class:b(["flex justify-between items-center p-3 rounded-lg",_===0?"bg-yellow-100":"bg-gray-50"])},[e("span",It,s(_+1)+". "+s(u.name),1),e("span",Ot,s(u.score)+" "+s(a.$t("game.points")),1)],2))),128))])]),e("div",Mt,[e("button",{onClick:n,class:"btn btn-primary"}," 🔄 "+s(a.$t("game.end.playAgain")),1),e("button",{onClick:c[2]||(c[2]=u=>a.$router.push("/")),class:"btn btn-secondary"}," 🏠 "+s(a.$t("game.backToHome")),1)])])])):m("",!0)])])}}});export{Gt as default};
