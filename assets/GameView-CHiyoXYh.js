import{d as G,l as Z,r as w,c as f,o as Q,n as ee,w as W,m as Y,a,b as e,e as g,t,p as J,q as S,j as n,f as x,F as R,h as O,u as te,s as X,i as se,x as K}from"./index-3ZC1B75g.js";const le={class:"card"},ne={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6"},ae={class:"flex-shrink-0"},oe={key:0,class:"w-32 h-32 rounded-lg shadow-lg bg-gray-200 flex items-center justify-center"},re=["src","alt"],ie={class:"flex-1 text-center md:text-left"},ce={key:0,class:"mb-4"},ue={class:"text-gray-600"},de={class:"text-sm text-gray-500"},ve={key:1,class:"mb-4"},me={class:"text-xl font-bold text-gray-800"},ge={class:"text-lg text-gray-600"},pe={class:"text-sm text-gray-500"},he={key:2,class:"mb-4"},fe={class:"text-xl font-bold text-gray-800"},ye={class:"text-lg text-gray-600"},ke={class:"text-gray-600"},be={class:"text-sm text-gray-500"},$e={class:"mb-4"},_e={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center"},xe={class:"flex items-center justify-center mb-2"},we={class:"text-lg font-semibold text-blue-800"},Te={class:"text-blue-700 mb-2"},Ce={class:"text-sm text-blue-600"},Me={class:"text-xs text-blue-500 mt-1"},Pe=["src"],Ae={key:2,class:"music-player-controls bg-gray-900 rounded-lg p-4"},ze={class:"flex items-center justify-center space-x-6 mb-4"},Se=["disabled"],Be=["disabled"],Le={key:0,class:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"},De={key:1,class:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20"},je={key:2,class:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20"},Ve=["disabled"],Ie={key:0,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},Ee={key:1,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},He={key:2,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},Ne={class:"mb-3"},Fe={class:"flex items-center space-x-3 text-xs text-gray-300"},Re={class:"w-12 text-right"},Oe={class:"flex-1 relative"},Ue={class:"w-12"},Ge={class:"flex items-center space-x-3"},qe={class:"flex-1 relative"},Je=["value","disabled"],Xe={class:"text-xs text-gray-400 w-8"},Ke={key:3,class:"p-4 bg-blue-50 border border-blue-200 rounded-lg"},Qe={class:"text-center"},We={class:"text-lg font-bold text-blue-800"},Ye={class:"text-blue-700"},Ze={class:"text-blue-600"},et={class:"text-sm text-blue-500 mt-2"},tt=["href"],st={key:0,class:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg"},lt={class:"text-center font-medium text-yellow-800"},nt={class:"text-center text-sm text-yellow-700 mt-1"},at={class:"font-bold text-lg"},ot={key:0,class:"text-sm mt-1"},rt=G({__name:"TrackPlayer",props:{track:{},difficulty:{},showAnswer:{type:Boolean,default:!1},showResult:{type:Boolean,default:!1},isCorrect:{type:Boolean,default:!1},pointsEarned:{default:0}},emits:["placeTrack"],setup(I,{emit:L}){const c=I,{t:T}=Z(),i=w(),v=w(!1),y=w(!1),b=w(!1),M=w(0),P=w(0),$=w(.7),h=w(!1),D=f(()=>{var k,U,F,q;const l=(U=(k=c.track.images)==null?void 0:k[0])==null?void 0:U.url,d=(q=(F=c.track.album.images)==null?void 0:F[0])==null?void 0:q.url;return l||d||"https://via.placeholder.com/300x300/6B7280/FFFFFF?text=No+Image"}),B=f(()=>c.track.artists.map(l=>l.name).join(", ")),s=f(()=>c.showResult?c.isCorrect?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800":""),o=f(()=>c.showResult?c.isCorrect?T("game.turn.correct",{year:c.track.year}):T("game.turn.incorrect",{year:c.track.year}):""),u=f(()=>P.value===0?0:M.value/P.value*100);function _(){i.value&&(console.log("Toggle playback called, isPlaying:",v.value,"canPlay:",b.value),v.value?i.value.pause():i.value.play().catch(l=>{console.error("Error playing audio:",l)}))}function A(){i.value&&(console.log("Restart track called"),i.value.currentTime=0,v.value&&i.value.play().catch(l=>{console.error("Error playing audio after restart:",l)}))}function j(){i.value&&(h.value?(i.value.volume=$.value,h.value=!1):(i.value.volume=0,h.value=!0))}function r(l){if(!i.value)return;const d=l.target,k=parseFloat(d.value);$.value=k,i.value.volume=k,k===0?h.value=!0:h.value&&(h.value=!1)}function m(l){if(!i.value||!c.track.preview_url)return;const k=l.currentTarget.getBoundingClientRect(),F=(l.clientX-k.left)/k.width*P.value;i.value.currentTime=F}function z(l){if(isNaN(l))return"0:00";const d=Math.floor(l/60),k=Math.floor(l%60);return`${d}:${k.toString().padStart(2,"0")}`}function E(){i.value&&(M.value=i.value.currentTime)}function H(){i.value&&(P.value=i.value.duration,i.value.volume=$.value)}function N(){y.value=!0,b.value=!1}function p(){y.value=!1,b.value=!0}function C(){v.value=!1}Q(()=>{ee(()=>{i.value&&V()})}),W(i,l=>{l&&V()});function V(){i.value&&(i.value.addEventListener("play",()=>{v.value=!0}),i.value.addEventListener("pause",()=>{v.value=!1}),i.value.volume=$.value)}return Y(()=>{i.value&&i.value.pause()}),(l,d)=>(n(),a("div",le,[e("div",ne,[e("div",ae,[l.showAnswer?(n(),a("img",{key:1,src:D.value,alt:l.track.name,class:"w-32 h-32 rounded-lg shadow-lg object-cover"},null,8,re)):(n(),a("div",oe,d[1]||(d[1]=[e("svg",{class:"w-16 h-16 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})],-1)])))]),e("div",ie,[l.difficulty==="original"?(n(),a("div",ce,[e("p",ue,t(l.$t("game.turn.listening")),1),e("p",de,t(l.$t("game.difficulties.originalHint")),1)])):l.difficulty==="pro"?(n(),a("div",ve,[e("h3",me,t(l.track.name),1),e("p",ge,t(B.value),1),e("p",pe,t(l.$t("game.difficulties.proHint")),1)])):l.difficulty==="expert"?(n(),a("div",he,[e("h3",fe,t(l.track.name),1),e("p",ye,t(B.value),1),e("p",ke,t(l.track.album.name),1),e("p",be,t(l.$t("game.difficulties.expertHint")),1)])):g("",!0),e("div",$e,[l.track.preview_url?g("",!0):(n(),a("div",_e,[e("div",xe,[d[2]||(d[2]=e("svg",{class:"w-8 h-8 text-blue-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})],-1)),e("h3",we,t(l.$t("game.demoMode")),1)]),e("p",Te,t(l.$t("game.noPreview")),1),e("p",Ce,[e("strong",null,t(l.$t("game.needSpotifyForAudio")),1)]),e("p",Me,t(l.$t("game.demoModeInstructions")),1)])),l.track.preview_url?(n(),a("audio",{key:1,ref_key:"audioPlayer",ref:i,src:l.track.preview_url,onEnded:C,onTimeupdate:E,onLoadedmetadata:H,onLoadstart:N,onCanplay:p,preload:"metadata"},t(l.$t("game.audioNotSupported")),41,Pe)):g("",!0),l.track.preview_url?(n(),a("div",Ae,[e("div",ze,[e("button",{onClick:A,class:"control-btn",disabled:!l.track.preview_url,title:"Restart"},d[3]||(d[3]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z","clip-rule":"evenodd"})],-1)]),8,Se),e("button",{onClick:_,class:"play-btn",disabled:!l.track.preview_url},[y.value?(n(),a("div",Le)):v.value?(n(),a("svg",De,d[4]||(d[4]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(n(),a("svg",je,d[5]||(d[5]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"},null,-1)])))],8,Be),e("button",{onClick:j,class:"control-btn",disabled:!l.track.preview_url,title:"Mute/Unmute"},[h.value||$.value===0?(n(),a("svg",Ie,d[6]||(d[6]=[e("path",{"fill-rule":"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.83 13.6H2a1 1 0 01-1-1V7.4a1 1 0 011-1h2.83l3.553-3.193a1 1 0 011.617.793zM16 8.4A1 1 0 1117.6 7a4 4 0 010 6 1 1 0 11-1.6-1.2 2 2 0 000-3.6z","clip-rule":"evenodd"},null,-1),e("path",{d:"M18.293 6.293a1 1 0 011.414 1.414L17.414 10l2.293 2.293a1 1 0 01-1.414 1.414L16 11.414l-2.293 2.293a1 1 0 01-1.414-1.414L14.586 10l-2.293-2.293a1 1 0 011.414-1.414L16 8.586l2.293-2.293z"},null,-1)]))):$.value<.5?(n(),a("svg",Ee,d[7]||(d[7]=[e("path",{"fill-rule":"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.83 13.6H2a1 1 0 01-1-1V7.4a1 1 0 011-1h2.83l3.553-3.193a1 1 0 011.617.793zM15 8.4A1 1 0 1116.6 7a2 2 0 010 6 1 1 0 11-1.6-1.2V8.4z","clip-rule":"evenodd"},null,-1)]))):(n(),a("svg",He,d[8]||(d[8]=[e("path",{"fill-rule":"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.83 13.6H2a1 1 0 01-1-1V7.4a1 1 0 011-1h2.83l3.553-3.193a1 1 0 011.617.793zM15 8.4A1 1 0 1116.6 7a4 4 0 010 6 1 1 0 11-1.6-1.2 2 2 0 000-3.6z","clip-rule":"evenodd"},null,-1)])))],8,Ve)]),e("div",Ne,[e("div",Fe,[e("span",Re,t(z(M.value)),1),e("div",Oe,[e("div",{class:"progress-track",onClick:d[0]||(d[0]=k=>m(k))},[e("div",{class:"progress-fill",style:J({width:u.value+"%"})},null,4),e("div",{class:"progress-handle",style:J({left:u.value+"%"})},null,4)])]),e("span",Ue,t(z(P.value)),1)])]),e("div",Ge,[d[9]||(d[9]=e("svg",{class:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.83 13.6H2a1 1 0 01-1-1V7.4a1 1 0 011-1h2.83l3.553-3.193a1 1 0 011.617.793z","clip-rule":"evenodd"})],-1)),e("div",qe,[e("input",{type:"range",min:"0",max:"1",step:"0.1",value:$.value,onInput:r,class:"volume-slider",disabled:!l.track.preview_url},null,40,Je)]),e("span",Xe,t(Math.round($.value*100))+"%",1)])])):g("",!0)]),l.showAnswer?(n(),a("div",Ke,[e("div",Qe,[e("h4",We,t(l.track.name),1),e("p",Ye,t(B.value),1),e("p",Ze,t(l.track.album.name)+" ("+t(l.track.year)+")",1),e("p",et,[e("a",{href:l.track.external_urls.spotify,target:"_blank",rel:"noopener noreferrer",class:"underline hover:no-underline"},t(l.$t("game.openInSpotify"))+" ↗ ",9,tt)])])])):g("",!0)])]),l.showAnswer?g("",!0):(n(),a("div",st,[e("p",lt,t(l.$t("game.turn.placing")),1),e("p",nt,t(l.$t("game.dragToTimeline")),1)])),l.showResult?(n(),a("div",{key:1,class:S(["mt-4 p-4 rounded-lg text-center",s.value])},[e("p",at,t(o.value),1),l.pointsEarned>0?(n(),a("p",ot,t(l.$t("game.turn.points",{points:l.pointsEarned})),1)):g("",!0)],2)):g("",!0)]))}}),it={class:"flex items-center justify-between mb-4"},ct={class:"text-lg font-semibold flex items-center space-x-2"},ut={key:0,class:"text-green-500"},dt={class:"text-right"},vt={class:"text-2xl font-bold"},mt={class:"flex items-center space-x-2 text-sm text-gray-600"},gt={key:0,class:"mb-4"},pt={class:"text-sm font-medium text-gray-700 mb-2"},ht={class:"flex space-x-2"},ft=["title"],yt=["title"],kt={class:"mb-4"},bt={class:"text-sm font-medium text-gray-700 mb-2"},$t={key:0,class:"text-center py-8 text-gray-500"},_t={class:"text-center text-gray-500"},xt={key:1,class:"space-y-2"},wt={class:"text-center text-gray-500 text-sm"},Tt={class:"flex items-center space-x-3"},Ct={class:"w-12 h-12 rounded object-cover flex-shrink-0 relative"},Mt=["src","alt"],Pt={key:1,class:"w-12 h-12 rounded bg-gray-200 flex items-center justify-center"},At={class:"flex-1 min-w-0"},zt={class:"font-medium truncate"},St={class:"text-sm text-gray-600 truncate"},Bt={class:"text-right flex-shrink-0"},Lt={class:"font-bold text-lg"},Dt=["onDragover","onDragleave","onDrop"],jt={class:"text-center text-gray-500 text-sm"},Vt={class:"text-center text-gray-500 text-sm"},It={class:"flex items-center space-x-3"},Et={class:"flex-1 min-w-0"},Ht={class:"font-medium text-blue-800"},Nt={class:"text-sm text-blue-600"},Ft={key:2,class:"mt-4 pt-4 border-t border-gray-200"},Rt={class:"flex justify-between text-sm text-gray-600"},Ot={key:0},Ut=G({__name:"PlayerTimeline",props:{player:{},isCurrent:{type:Boolean},currentTrack:{},canPlace:{type:Boolean}},emits:["placeTrack","useToken"],setup(I,{emit:L}){const c=I,T=L,i=w(!1),v=w([]),y=f(()=>{if(c.player.timeline.length<2)return null;const s=c.player.timeline.map(o=>o.year).sort((o,u)=>o-u);return`${s[0]} - ${s[s.length-1]}`});function b(s){var o,u,_,A;return((u=(o=s.images)==null?void 0:o[0])==null?void 0:u.url)||((A=(_=s.album.images)==null?void 0:_[0])==null?void 0:A.url)||"/placeholder-album.png"}function M(s){return s.artists.map(o=>o.name).join(", ")}function P(s){var u;if(!c.currentTrack)return;(u=s.dataTransfer)==null||u.setData("text/plain",JSON.stringify(c.currentTrack)),s.target.classList.add("dragging")}function $(s){s.target.classList.remove("dragging"),i.value=!1,v.value=[]}function h(s){!c.currentTrack||!c.canPlace||(i.value=!1,v.value=[],T("placeTrack",c.currentTrack,s))}function D(s){T("useToken",s)}function B(){v.value=new Array(c.player.timeline.length+1).fill(!1)}return W(()=>c.player.timeline.length,()=>{B()},{immediate:!0}),(s,o)=>(n(),a("div",{class:S(["card",{"ring-2 ring-green-500":s.isCurrent}])},[e("div",it,[e("h3",ct,[e("span",null,t(s.player.name),1),s.isCurrent?(n(),a("span",ut,"👑")):g("",!0)]),e("div",dt,[e("p",vt,t(s.player.score),1),e("div",mt,[o[11]||(o[11]=e("span",null,"🎵",-1)),e("span",null,t(s.$t("game.score.tokens",{count:s.player.tokens})),1)])])]),s.isCurrent&&s.canPlace&&s.player.tokens>0?(n(),a("div",gt,[e("h4",pt,t(s.$t("game.tokenAbilities")),1),e("div",ht,[e("button",{onClick:o[0]||(o[0]=u=>D("skip")),class:"btn btn-sm bg-yellow-100 hover:bg-yellow-200 text-yellow-800",title:s.$t("game.tokens.skip.description")}," ⏭️ "+t(s.$t("game.tokens.skip.label")),9,ft),e("button",{onClick:o[1]||(o[1]=u=>D("hint")),class:"btn btn-sm bg-blue-100 hover:bg-blue-200 text-blue-800",title:s.$t("game.tokens.hint.description")}," 💡 "+t(s.$t("game.tokens.hint.label")),9,yt)])])):g("",!0),e("div",kt,[e("h4",bt,t(s.$t("game.timeline.title")),1),s.player.timeline.length===0?(n(),a("div",$t,[e("p",null,t(s.$t("game.timeline.empty")),1),s.canPlace?(n(),a("div",{key:0,class:S(["timeline-slot mt-4",{"drag-over":i.value}]),onDragover:o[2]||(o[2]=x(u=>i.value=!0,["prevent"])),onDragleave:o[3]||(o[3]=x(u=>i.value=!1,["prevent"])),onDrop:o[4]||(o[4]=x(u=>h(0),["prevent"]))},[e("p",_t,t(s.$t("game.timeline.placeHere")),1)],34)):g("",!0)])):(n(),a("div",xt,[s.canPlace?(n(),a("div",{key:0,class:S(["timeline-slot h-16",{"drag-over":v.value[0]}]),onDragover:o[5]||(o[5]=x(u=>v.value[0]=!0,["prevent"])),onDragleave:o[6]||(o[6]=x(u=>v.value[0]=!1,["prevent"])),onDrop:o[7]||(o[7]=x(u=>h(0),["prevent"]))},[e("p",wt,t(s.$t("game.placeEarlier")),1)],34)):g("",!0),(n(!0),a(R,null,O(s.player.timeline,(u,_)=>(n(),a("div",{key:u.id,class:"track-card"},[e("div",Tt,[e("div",Ct,[u.revealed?(n(),a("img",{key:0,src:b(u),alt:u.name,class:"w-12 h-12 rounded object-cover"},null,8,Mt)):(n(),a("div",Pt,o[12]||(o[12]=[e("svg",{class:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})],-1)])))]),e("div",At,[e("p",zt,t(u.name),1),e("p",St,t(M(u)),1)]),e("div",Bt,[e("p",Lt,t(u.year),1)])]),s.canPlace&&_<s.player.timeline.length-1?(n(),a("div",{key:0,class:S(["timeline-slot h-16 mt-2",{"drag-over":v.value[_+1]}]),onDragover:x(A=>v.value[_+1]=!0,["prevent"]),onDragleave:x(A=>v.value[_+1]=!1,["prevent"]),onDrop:x(A=>h(_+1),["prevent"])},[e("p",jt,t(s.$t("game.placeBetween")),1)],42,Dt)):g("",!0)]))),128)),s.canPlace?(n(),a("div",{key:1,class:S(["timeline-slot h-16",{"drag-over":v.value[s.player.timeline.length]}]),onDragover:o[8]||(o[8]=x(u=>v.value[s.player.timeline.length]=!0,["prevent"])),onDragleave:o[9]||(o[9]=x(u=>v.value[s.player.timeline.length]=!1,["prevent"])),onDrop:o[10]||(o[10]=x(u=>h(s.player.timeline.length),["prevent"]))},[e("p",Vt,t(s.$t("game.placeLater")),1)],34)):g("",!0)]))]),s.canPlace&&s.currentTrack?(n(),a("div",{key:1,class:"p-4 bg-blue-50 border-2 border-blue-200 rounded-lg cursor-move",draggable:"true",onDragstart:P,onDragend:$},[e("div",It,[o[13]||(o[13]=e("div",{class:"w-12 h-12 rounded bg-blue-200 flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-6 h-6 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})])],-1)),e("div",Et,[e("p",Ht,t(s.$t("game.newTrack")),1),e("p",Nt,t(s.$t("game.dragToPlace")),1)]),o[14]||(o[14]=e("div",{class:"text-blue-500"},[e("span",{class:"text-2xl"},"🎵")],-1))])],32)):g("",!0),s.player.timeline.length>0?(n(),a("div",Ft,[e("div",Rt,[e("span",null,t(s.$t("game.tracksInTimeline",{count:s.player.timeline.length})),1),y.value?(n(),a("span",Ot,t(y.value),1)):g("",!0)])])):g("",!0)],2))}}),Gt={class:"min-h-screen flex flex-col"},qt={class:"bg-white/10 backdrop-blur-sm p-4"},Jt={class:"flex justify-between items-center"},Xt={class:"flex items-center space-x-4"},Kt={class:"text-white"},Qt={class:"text-xl font-bold"},Wt={class:"text-sm opacity-80"},Yt={class:"text-white text-right"},Zt={class:"text-sm opacity-80"},es={class:"flex-1 container mx-auto px-4 py-6"},ts={key:0,class:"max-w-2xl mx-auto"},ss={class:"card text-center"},ls={class:"text-2xl font-semibold mb-4"},ns={class:"text-gray-600 mb-6"},as={key:1,class:"space-y-6"},os={class:"card text-center bg-green-50 border-green-200"},rs={class:"text-2xl font-bold text-green-800 mb-2"},is={class:"text-green-700"},cs={key:0,class:"mt-4"},us={key:1,class:"mt-4"},ds={class:"flex items-center justify-center space-x-2"},vs={key:0,class:"card bg-yellow-50 border-yellow-200"},ms={class:"flex items-center space-x-3"},gs={class:"flex-1"},ps={class:"text-lg font-semibold text-yellow-800"},hs={class:"text-yellow-700 text-sm"},fs={class:"flex space-x-2"},ys={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ks={class:"card"},bs={class:"text-lg font-semibold mb-4"},$s={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},_s={class:"font-semibold"},xs={class:"text-2xl font-bold text-green-600"},ws={class:"text-sm text-gray-600"},Ts={class:"text-xs text-gray-500"},Cs={key:2,class:"max-w-2xl mx-auto"},Ms={class:"card text-center"},Ps={class:"text-3xl font-bold mb-4 text-green-600"},As={class:"text-xl mb-6"},zs={class:"mb-6"},Ss={class:"text-lg font-semibold mb-3"},Bs={class:"space-y-2"},Ls={class:"font-medium"},Ds={class:"font-bold"},js={class:"flex space-x-4 justify-center"},Is=G({__name:"GameView",setup(I){const L=se(),c=te(),T=w(!1),i=w(X.isAuthenticated()),v=f(()=>c.players),y=f(()=>c.currentPlayer),b=f(()=>c.currentTrack),M=f(()=>c.gamePhase),P=f(()=>c.round),$=f(()=>c.settings),h=f(()=>c.winner),D=f(()=>i.value),B=f(()=>[...v.value].sort((r,m)=>m.tokens!==r.tokens?m.tokens-r.tokens:m.score-r.score));async function s(){T.value=!0;try{await c.getNextTrack()||console.error("No tracks available")}catch(r){console.error("Error loading track:",r)}finally{T.value=!1}}function o(r,m){c.placeTrackOnTimeline(r,m),setTimeout(()=>{c.nextPlayer()},2e3)}function u(r){var z;if(!y.value)return;if(c.useToken(y.value.id,r))switch(r){case"skip":s();break;case"hint":alert(`Hint: This track was released in the ${Math.floor(((z=b.value)==null?void 0:z.year)/10)*10}s`);break}}function _(){c.resetGame(),L.push("/")}function A(){L.push("/")}function j(){const r=X.isAuthenticated(),m=localStorage.getItem("spotify_auth");console.log("Spotify auth check:",{isAuthenticated:r,authStateInStorage:m?JSON.parse(m):null,currentValue:i.value}),i.value=r}return Q(()=>{c.gamePhase==="setup"&&c.players.length===0&&L.push("/"),j();const r=setInterval(()=>{j()},2e3);Y(()=>{clearInterval(r)})}),(r,m)=>{var z,E,H,N;return n(),a("div",Gt,[e("header",qt,[e("div",Jt,[e("div",Xt,[e("button",{onClick:m[0]||(m[0]=p=>r.$router.push("/")),class:"btn btn-secondary"}," ← "+t(r.$t("common.back")),1),e("div",Kt,[e("h1",Qt,t(r.$t("game.title")),1),e("p",Wt,t(r.$t("game.round"))+" "+t(P.value),1)])]),e("div",Yt,[e("p",Zt,t(r.$t("game.turn.currentPlayer",{player:(z=y.value)==null?void 0:z.name})),1)])])]),e("main",es,[M.value==="setup"?(n(),a("div",ts,[e("div",ss,[e("h2",ls,t(r.$t("game.setupRequired")),1),e("p",ns,t(r.$t("game.setupMessage")),1),e("button",{onClick:m[1]||(m[1]=p=>r.$router.push("/")),class:"btn btn-primary"},t(r.$t("game.backToSetup")),1)])])):M.value==="playing"?(n(),a("div",as,[e("div",os,[e("h2",rs,t(r.$t("game.turn.currentPlayer",{player:(E=y.value)==null?void 0:E.name})),1),e("p",is,t(r.$t("game.turn.ready")),1),!b.value&&!T.value?(n(),a("div",cs,[e("button",{onClick:s,class:"btn btn-primary btn-lg"}," 🎵 "+t(r.$t("game.getTrack")),1)])):g("",!0),T.value?(n(),a("div",us,[e("div",ds,[m[3]||(m[3]=e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-green-500"},null,-1)),e("span",null,t(r.$t("common.loading")),1)])])):g("",!0)]),D.value?g("",!0):(n(),a("div",vs,[e("div",ms,[m[4]||(m[4]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 18.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("div",gs,[e("h3",ps,t(r.$t("game.spotify.notConnected")),1),e("p",hs,t(r.$t("game.demoModeActive")),1)]),e("div",fs,[e("button",{onClick:A,class:"btn btn-sm bg-yellow-600 hover:bg-yellow-700 text-white"},t(r.$t("game.spotify.login")),1),e("button",{onClick:j,class:"btn btn-sm bg-blue-600 hover:bg-blue-700 text-white"}," 🔄 Refresh ")])])])),b.value?(n(),K(rt,{key:1,track:b.value,difficulty:$.value.difficulty,onPlaceTrack:o},null,8,["track","difficulty"])):g("",!0),e("div",ys,[(n(!0),a(R,null,O(v.value,p=>{var C,V;return n(),K(Ut,{key:p.id,player:p,"is-current":p.id===((C=y.value)==null?void 0:C.id),"current-track":b.value,"can-place":p.id===((V=y.value)==null?void 0:V.id)&&!!b.value,onPlaceTrack:o,onUseToken:u},null,8,["player","is-current","current-track","can-place"])}),128))]),e("div",ks,[e("h3",bs,t(r.$t("game.score.title")),1),e("div",$s,[(n(!0),a(R,null,O(v.value,p=>{var C;return n(),a("div",{key:p.id,class:S(["text-center p-3 rounded-lg",p.id===((C=y.value)==null?void 0:C.id)?"bg-green-100":"bg-gray-50"])},[e("p",_s,t(p.name),1),e("p",xs,t(p.tokens),1),e("p",ws,t(r.$t("game.score.tokens",{count:p.tokens})),1),e("p",Ts,t(r.$t("game.score.total",{score:p.score})),1)],2)}),128))])])])):M.value==="finished"?(n(),a("div",Cs,[e("div",Ms,[e("h2",Ps,t(r.$t("game.end.title")),1),e("p",As,t(r.$t("game.end.winner",{player:(H=h.value)==null?void 0:H.name,score:(N=h.value)==null?void 0:N.tokens})),1),e("div",zs,[e("h3",Ss,t(r.$t("game.end.finalScores")),1),e("div",Bs,[(n(!0),a(R,null,O(B.value,(p,C)=>(n(),a("div",{key:p.id,class:S(["flex justify-between items-center p-3 rounded-lg",C===0?"bg-yellow-100":"bg-gray-50"])},[e("span",Ls,t(C+1)+". "+t(p.name),1),e("span",Ds,t(p.tokens)+" "+t(r.$t("game.score.tokens",{count:p.tokens})),1)],2))),128))])]),e("div",js,[e("button",{onClick:_,class:"btn btn-primary"}," 🔄 "+t(r.$t("game.end.playAgain")),1),e("button",{onClick:m[2]||(m[2]=p=>r.$router.push("/")),class:"btn btn-secondary"}," 🏠 "+t(r.$t("game.backToHome")),1)])])])):g("",!0)])])}}});export{Is as default};
