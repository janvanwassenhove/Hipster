import{d as ee,m as ve,r as b,c as h,s as w,o as ae,n as J,w as Z,p as te,a as d,e,b as m,q as le,t as a,f as K,x as se,y as D,k as i,g as C,F as Q,i as W,u as me,j as fe,z as he,A as be}from"./index-DwsvpCua.js";const ye={class:"card relative overflow-hidden bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 border border-purple-500/20 shadow-2xl shadow-purple-500/10"},xe={class:"relative z-10 flex flex-col md:flex-row items-center space-y-6 md:space-y-0 md:space-x-8 p-6"},ke={class:"flex-shrink-0"},we={key:0,class:"relative group"},$e={key:1,class:"relative group"},_e=["src","alt"],Te={class:"flex-1 text-center md:text-left"},Pe={class:"mb-6"},Ce={class:"text-gray-300 font-medium text-lg bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent"},Me={class:"text-sm text-gray-400 mt-2 font-light"},ze={class:"mb-6"},Se={key:0,class:"bg-gradient-to-r from-green-900/50 to-emerald-900/50 border border-green-400/30 rounded-2xl p-6 text-center backdrop-blur-sm"},Ae={class:"flex items-center justify-center mb-3"},je={class:"text-xl font-bold bg-gradient-to-r from-green-300 to-emerald-300 bg-clip-text text-transparent"},De={class:"text-green-200 mb-4 font-medium"},Be={key:1,class:"bg-gradient-to-r from-blue-900/50 to-purple-900/50 border border-blue-400/30 rounded-2xl p-6 text-center backdrop-blur-sm"},Le={class:"flex items-center justify-center mb-3"},Ee={class:"text-xl font-bold bg-gradient-to-r from-blue-300 to-purple-300 bg-clip-text text-transparent"},Ie={class:"text-blue-200 mb-3 font-medium"},Re={class:"text-sm text-blue-300 font-semibold"},Ve={class:"text-xs text-blue-400 mt-2 opacity-80"},Ne=["src"],Fe={key:3,class:"music-player-controls bg-gradient-to-br from-gray-900/80 to-black/80 rounded-2xl p-6 backdrop-blur-sm border border-gray-700/50 shadow-2xl"},Oe={class:"flex items-center justify-center space-x-8 mb-6"},Xe=["disabled"],He=["disabled"],Ue={class:"w-16 h-16 bg-gradient-to-br from-purple-600 to-pink-600 rounded-full flex items-center justify-center shadow-2xl shadow-purple-500/50 group-hover:from-purple-500 group-hover:to-pink-500 transition-all duration-300 group-hover:scale-110 group-hover:shadow-purple-400/60"},Ye={key:0,class:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"},qe={key:1,class:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20"},Ge={key:2,class:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20"},Je=["disabled"],Ze={class:"w-12 h-12 bg-gradient-to-br from-gray-800 to-gray-900 rounded-full flex items-center justify-center border border-gray-600/50 shadow-lg group-hover:from-cyan-600 group-hover:to-blue-600 group-hover:border-cyan-400/50 transition-all duration-300 group-hover:scale-110"},Ke={key:0,class:"w-5 h-5 text-gray-300 group-hover:text-white transition-colors duration-300",fill:"currentColor",viewBox:"0 0 20 20"},Qe={key:1,class:"w-5 h-5 text-gray-300 group-hover:text-white transition-colors duration-300",fill:"currentColor",viewBox:"0 0 20 20"},We={key:2,class:"w-5 h-5 text-gray-300 group-hover:text-white transition-colors duration-300",fill:"currentColor",viewBox:"0 0 20 20"},et={class:"mb-4"},tt={class:"flex items-center space-x-4 text-sm text-gray-300"},ot={class:"w-12 text-right font-mono"},rt={class:"flex-1 relative"},st={class:"w-12 font-mono"},at={class:"flex items-center space-x-4"},lt={class:"flex-1 relative group"},nt=["value","disabled"],it={class:"text-sm text-gray-400 w-10 font-mono"},ut={key:0,class:"p-6 bg-gradient-to-r from-blue-900/40 to-purple-900/40 border border-blue-400/30 rounded-2xl backdrop-blur-sm"},dt={class:"text-center"},ct={class:"text-2xl font-bold bg-gradient-to-r from-blue-300 to-purple-300 bg-clip-text text-transparent mb-2"},gt={class:"text-blue-200 text-lg font-medium mb-1"},pt={class:"text-blue-300 font-medium"},vt={class:"text-sm text-blue-400 mt-4"},mt=["href"],ft={key:0,class:"mt-6 p-6 bg-gradient-to-r from-purple-900/30 to-pink-900/30 border border-purple-400/30 rounded-2xl backdrop-blur-sm"},ht={class:"text-center"},bt={class:"flex items-center justify-center mb-3"},yt={class:"font-bold text-lg bg-gradient-to-r from-purple-300 to-pink-300 bg-clip-text text-transparent"},xt={class:"text-purple-200 text-sm font-medium"},kt={class:"flex items-center justify-center mb-3"},wt={key:0,class:"w-12 h-12 bg-gradient-to-br from-cyan-500 to-blue-500 rounded-full flex items-center justify-center mr-3 animate-bounce"},$t={key:1,class:"w-12 h-12 bg-gradient-to-br from-red-500 to-pink-500 rounded-full flex items-center justify-center mr-3 animate-pulse"},_t={class:"font-bold text-2xl"},Tt={key:0,class:"text-lg mt-2 font-semibold"},Pt={class:"bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent"},Ct=ee({__name:"TrackPlayer",props:{track:{},showAnswer:{type:Boolean,default:!1},showResult:{type:Boolean,default:!1},isCorrect:{type:Boolean,default:!1},pointsEarned:{default:0}},emits:["placeTrack"],setup(I,{emit:B}){const n=I,{t:$}=ve(),c=b(),p=b(!1),_=b(!1),R=b(!1),x=b(0),g=b(0),k=b(.7),M=b(!1),j=b(!1);b(!1);const V=h(()=>{var v,A,q,U;const r=(A=(v=n.track.images)==null?void 0:v[0])==null?void 0:A.url,l=(U=(q=n.track.album.images)==null?void 0:q[0])==null?void 0:U.url;return r||l||"https://via.placeholder.com/300x300/6B7280/FFFFFF?text=No+Image"}),Y=h(()=>n.track.artists.map(r=>r.name).join(", ")),L=h(()=>n.showResult?n.isCorrect?"bg-gradient-to-r from-cyan-900/40 to-blue-900/40 border border-cyan-400/30 text-cyan-100":"bg-gradient-to-r from-red-900/40 to-pink-900/40 border border-red-400/30 text-red-100":""),N=h(()=>n.showResult?n.isCorrect?$("game.turn.correct",{year:n.track.year}):$("game.turn.incorrect",{year:n.track.year}):""),F=h(()=>g.value===0?0:x.value/g.value*100),S=h(()=>!!n.track.uri),O=h(()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)),T=h(()=>S.value&&w.isPlayerReady()&&!O.value),P=h(()=>!!n.track.preview_url),s=h(()=>T.value||P.value);async function o(){console.log("Toggle playback called, isPlaying:",p.value),console.log("Can play full track:",T.value),console.log("Can play preview:",P.value),console.log("Spotify player ready:",w.isPlayerReady());const r=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(T.value&&!r){if(await w.getAvailableDevices(),p.value)await w.pausePlayback(),p.value=!1;else if(await w.playTrack(n.track.uri))p.value=!0,f();else if(console.warn("Failed to play track, falling back to preview if available"),P.value&&c.value)try{await c.value.play()}catch(v){console.error("Error playing preview fallback:",v)}}else if(P.value&&c.value)if(p.value)c.value.pause();else try{await c.value.play()}catch(l){console.error("Error playing audio:",l),l instanceof Error&&l.name==="NotAllowedError"&&console.warn("Autoplay blocked - user interaction required")}else r&&S.value&&t()}function t(){var l;console.log("Opening track in Spotify");const r=((l=n.track.external_urls)==null?void 0:l.spotify)||`https://open.spotify.com/track/${n.track.id}`;window.open(r,"_blank")}async function u(){console.log("Restart track called"),T.value?await w.playTrack(n.track.uri)&&(p.value=!0,f()):c.value&&(c.value.currentTime=0,p.value&&c.value.play().catch(r=>{console.error("Error playing audio after restart:",r)}))}function f(){const r=async()=>{if(!T.value)return;const l=await w.getPlaybackState();l&&(p.value=!l.paused,x.value=l.position/1e3,g.value=l.duration/1e3,p.value&&setTimeout(r,1e3))};r()}function z(){c.value&&(M.value?(c.value.volume=k.value,M.value=!1):(c.value.volume=0,M.value=!0))}function E(r){if(!c.value)return;const l=r.target,v=parseFloat(l.value);k.value=v,c.value.volume=v,v===0?M.value=!0:M.value&&(M.value=!1)}function H(r){r.stopPropagation()}function y(r){if(!c.value||!n.track.preview_url)return;const v=r.currentTarget.getBoundingClientRect();let A;if("touches"in r)if(r.touches.length>0)A=r.touches[0].clientX;else if(r.changedTouches.length>0)A=r.changedTouches[0].clientX;else return;else A=r.clientX;const U=Math.max(0,Math.min(1,(A-v.left)/v.width))*g.value;c.value.currentTime=U}function X(r){!c.value||!n.track.preview_url||(r.preventDefault(),j.value=!0,G(r))}function ne(r){j.value&&(r.preventDefault(),G(r))}function ie(r){j.value&&(r.preventDefault(),j.value=!1,G(r))}function G(r){if(!c.value||!n.track.preview_url)return;const v=r.currentTarget.getBoundingClientRect(),A=r.touches[0]||r.changedTouches[0];if(!A)return;const U=Math.max(0,Math.min(1,(A.clientX-v.left)/v.width))*g.value;c.value.currentTime=U}function oe(r){if(isNaN(r))return"0:00";const l=Math.floor(r/60),v=Math.floor(r%60);return`${l}:${v.toString().padStart(2,"0")}`}function ue(){c.value&&(x.value=c.value.currentTime)}function de(){c.value&&(g.value=c.value.duration,c.value.volume=k.value)}function ce(){_.value=!0,R.value=!1}function ge(){_.value=!1,R.value=!0}function pe(){p.value=!1}ae(()=>{w.isAuthenticated()&&J(()=>{w.initializePlayerIfReady()}),J(()=>{c.value&&re()})}),Z(c,r=>{r&&re()}),Z(()=>n.track,async(r,l)=>{r&&r!==l&&(console.log("New track detected:",r.name),await J(),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?console.log("Mobile device detected - autoplay disabled due to browser policies"):setTimeout(async()=>{s.value&&!p.value&&await o()},100))},{immediate:!1});function re(){c.value&&(c.value.addEventListener("play",()=>{p.value=!0}),c.value.addEventListener("pause",()=>{p.value=!1}),c.value.volume=k.value,O.value&&c.value.addEventListener("touchstart",r=>{r.preventDefault()},{passive:!1}))}return te(()=>{T.value?w.stopPlayback():c.value&&c.value.pause()}),(r,l)=>(i(),d("div",ye,[l[21]||(l[21]=e("div",{class:"absolute inset-0 opacity-10"},[e("div",{class:"absolute top-0 left-0 w-72 h-72 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full blur-3xl animate-pulse"}),e("div",{class:"absolute bottom-0 right-0 w-96 h-96 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full blur-3xl animate-pulse delay-1000"})],-1)),e("div",xe,[e("div",ke,[r.showAnswer?(i(),d("div",$e,[e("img",{src:V.value,alt:r.track.name,class:"w-40 h-40 rounded-2xl shadow-2xl object-cover border border-gray-700/50 backdrop-blur-sm transform group-hover:scale-105 transition-transform duration-300"},null,8,_e),l[5]||(l[5]=e("div",{class:"absolute inset-0 w-40 h-40 rounded-2xl bg-gradient-to-br from-cyan-500/20 to-blue-500/20 blur-xl group-hover:blur-2xl transition-all duration-300"},null,-1))])):(i(),d("div",we,l[4]||(l[4]=[le('<div class="w-40 h-40 rounded-2xl shadow-2xl bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center border border-gray-700/50 backdrop-blur-sm" data-v-de71a751><div class="w-32 h-32 rounded-full bg-gradient-to-br from-gray-900 to-black shadow-inner flex items-center justify-center" data-v-de71a751><div class="w-20 h-20 rounded-full bg-gradient-to-br from-gray-800 to-gray-900 shadow-inner flex items-center justify-center" data-v-de71a751><svg class="w-12 h-12 text-gray-400 animate-spin-slow" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-de71a751><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3" data-v-de71a751></path></svg></div></div></div><div class="absolute inset-0 w-40 h-40 rounded-2xl bg-gradient-to-br from-purple-500/20 to-pink-500/20 blur-xl group-hover:blur-2xl transition-all duration-300" data-v-de71a751></div>',2)])))]),e("div",Te,[e("div",Pe,[e("p",Ce,a(r.$t("game.turn.listening")),1),e("p",Me,a(r.$t("game.turn.placeOnTimeline")),1)]),e("div",ze,[!s.value&&O.value&&S.value?(i(),d("div",Se,[e("div",Ae,[l[6]||(l[6]=e("div",{class:"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center mr-3 shadow-lg"},[e("svg",{class:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm-1 15l-5-5 1.414-1.414L11 14.172l7.586-7.586L20 8l-9 9z"})])],-1)),e("h3",je,a(r.$t("game.openInSpotify")),1)]),e("p",De,a(r.$t("game.mobileSpotifyRedirect")),1),e("button",{onClick:t,class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white font-bold rounded-full transition-all duration-300 shadow-lg hover:shadow-green-500/25 hover:scale-105"},[l[7]||(l[7]=e("svg",{class:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M12 0C5.376 0 0 5.376 0 12s5.376 12 12 12 12-5.376 12-12S18.624 0 12 0zm5.568 17.504c-.24.384-.768.504-1.152.264-3.168-1.944-7.152-2.376-11.856-1.296-.456.12-.912-.192-1.032-.648-.12-.456.192-.912.648-1.032 5.136-1.176 9.6-.624 13.056 1.512.384.24.504.768.264 1.152zm1.632-3.624c-.288.456-.912.6-1.368.312-3.624-2.232-9.168-2.88-13.464-1.584-.552.168-1.128-.192-1.296-.744-.168-.552.192-1.128.744-1.296 4.896-1.488 11.04-.768 15.168 1.8.456.288.6.912.312 1.368zm.144-3.792c-4.344-2.592-11.52-2.832-15.672-1.56-.672.204-1.368-.168-1.572-.84-.204-.672.168-1.368.84-1.572 4.776-1.464 12.624-1.176 17.736 1.8.528.312.696 1.008.384 1.536-.312.528-1.008.696-1.536.384z"})],-1)),K(" "+a(r.$t("game.playInSpotify")),1)])])):T.value?m("",!0):(i(),d("div",Be,[e("div",Le,[l[8]||(l[8]=e("div",{class:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mr-3 shadow-lg"},[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})])],-1)),e("h3",Ee,a(S.value?r.$t("game.premiumRequired"):r.$t("game.demoMode")),1)]),e("p",Ie,a(S.value?r.$t("game.needsPremium"):r.$t("game.noPreview")),1),e("p",Re,[e("strong",null,a(S.value?r.$t("game.premiumNeededForFullPlay"):r.$t("game.needSpotifyForAudio")),1)]),e("p",Ve,a(r.$t("game.demoModeInstructions")),1)])),P.value&&!T.value?(i(),d("audio",{key:2,ref_key:"audioPlayer",ref:c,src:r.track.preview_url||void 0,onEnded:pe,onTimeupdate:ue,onLoadedmetadata:de,onLoadstart:ce,onCanplay:ge,preload:"metadata",playsinline:"","webkit-playsinline":"",crossorigin:"anonymous"},a(r.$t("game.audioNotSupported")),41,Ne)):m("",!0),s.value?(i(),d("div",Fe,[e("div",Oe,[e("button",{onClick:u,class:"control-btn group relative",disabled:!s.value,title:"Restart"},l[9]||(l[9]=[e("div",{class:"w-12 h-12 bg-gradient-to-br from-gray-800 to-gray-900 rounded-full flex items-center justify-center border border-gray-600/50 shadow-lg group-hover:from-purple-600 group-hover:to-pink-600 group-hover:border-purple-400/50 transition-all duration-300 group-hover:scale-110"},[e("svg",{class:"w-5 h-5 text-gray-300 group-hover:text-white transition-colors duration-300",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z","clip-rule":"evenodd"})])],-1)]),8,Xe),e("button",{onClick:o,class:"play-btn group relative",disabled:!s.value},[e("div",Ue,[_.value?(i(),d("div",Ye)):p.value?(i(),d("svg",qe,l[10]||(l[10]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(i(),d("svg",Ge,l[11]||(l[11]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"},null,-1)])))])],8,He),e("button",{onClick:z,class:"control-btn group relative",disabled:!s.value,title:"Mute/Unmute"},[e("div",Ze,[M.value||k.value===0?(i(),d("svg",Ke,l[12]||(l[12]=[e("path",{"fill-rule":"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.83 13.6H2a1 1 0 01-1-1V7.4a1 1 0 011-1h2.83l3.553-3.193a1 1 0 011.617.793zM16 8.4A1 1 0 1117.6 7a4 4 0 010 6 1 1 0 11-1.6-1.2 2 2 0 000-3.6z","clip-rule":"evenodd"},null,-1),e("path",{d:"M18.293 6.293a1 1 0 011.414 1.414L17.414 10l2.293 2.293a1 1 0 01-1.414 1.414L16 11.414l-2.293 2.293a1 1 0 01-1.414-1.414L14.586 10l-2.293-2.293a1 1 0 011.414-1.414L16 8.586l2.293-2.293z"},null,-1)]))):k.value<.5?(i(),d("svg",Qe,l[13]||(l[13]=[e("path",{"fill-rule":"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.83 13.6H2a1 1 0 01-1-1V7.4a1 1 0 011-1h2.83l3.553-3.193a1 1 0 011.617.793zM15 8.4A1 1 0 1116.6 7a2 2 0 010 6 1 1 0 11-1.6-1.2V8.4z","clip-rule":"evenodd"},null,-1)]))):(i(),d("svg",We,l[14]||(l[14]=[e("path",{"fill-rule":"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.83 13.6H2a1 1 0 01-1-1V7.4a1 1 0 011-1h2.83l3.553-3.193a1 1 0 011.617.793zM15 8.4A1 1 0 1116.6 7a4 4 0 010 6 1 1 0 11-1.6-1.2 2 2 0 000-3.6z","clip-rule":"evenodd"},null,-1)])))])],8,Je)]),e("div",et,[e("div",tt,[e("span",ot,a(oe(x.value)),1),e("div",rt,[e("div",{class:"progress-track relative h-2 bg-gradient-to-r from-gray-800 to-gray-700 rounded-full cursor-pointer group overflow-hidden",onClick:l[0]||(l[0]=v=>y(v)),onTouchstart:l[1]||(l[1]=v=>X(v)),onTouchmove:l[2]||(l[2]=v=>ne(v)),onTouchend:l[3]||(l[3]=v=>ie(v))},[l[15]||(l[15]=e("div",{class:"absolute inset-0 bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-full blur-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),e("div",{class:"progress-fill absolute top-0 left-0 h-full bg-gradient-to-r from-purple-500 to-pink-500 rounded-full shadow-lg transition-all duration-150 ease-out",style:se({width:F.value+"%"})},null,4),e("div",{class:"progress-handle absolute top-1/2 w-4 h-4 bg-white rounded-full shadow-lg transform -translate-y-1/2 -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",style:se({left:F.value+"%"})},null,4)],32)]),e("span",st,a(oe(g.value)),1)])]),e("div",at,[l[16]||(l[16]=e("svg",{class:"w-5 h-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.83 13.6H2a1 1 0 01-1-1V7.4a1 1 0 011-1h2.83l3.553-3.193a1 1 0 011.617.793z","clip-rule":"evenodd"})],-1)),e("div",lt,[e("input",{type:"range",min:"0",max:"1",step:"0.1",value:k.value,onInput:E,onTouchstart:H,onTouchmove:H,onTouchend:H,class:"volume-slider w-full h-2 bg-gradient-to-r from-gray-800 to-gray-700 rounded-full appearance-none cursor-pointer slider-thumb",disabled:!r.track.preview_url},null,40,nt)]),e("span",it,a(Math.round(k.value*100))+"%",1)])])):m("",!0)]),r.showAnswer?(i(),d("div",ut,[e("div",dt,[e("h4",ct,a(r.track.name),1),e("p",gt,a(Y.value),1),e("p",pt,a(r.track.album.name)+" ("+a(r.track.year)+")",1),e("p",vt,[e("a",{href:r.track.external_urls.spotify,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-full hover:from-green-500 hover:to-green-400 transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-green-500/25"},[l[17]||(l[17]=e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"})],-1)),K(" "+a(r.$t("game.openInSpotify")),1)],8,mt)])])])):m("",!0)])]),r.showAnswer?m("",!0):(i(),d("div",ft,[e("div",ht,[e("div",bt,[l[18]||(l[18]=e("div",{class:"w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center mr-3 animate-pulse"},[e("svg",{class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("p",yt,a(r.$t("game.turn.placing")),1)]),e("p",xt,a(r.$t("game.dragToTimeline")),1)])])),r.showResult?(i(),d("div",{key:1,class:D(["mt-6 p-6 rounded-2xl text-center backdrop-blur-sm",L.value])},[e("div",kt,[r.isCorrect?(i(),d("div",wt,l[19]||(l[19]=[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]))):(i(),d("div",$t,l[20]||(l[20]=[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))),e("p",_t,a(N.value),1)]),r.pointsEarned>0?(i(),d("p",Tt,[e("span",Pt,a(r.$t("game.turn.points",{points:r.pointsEarned})),1)])):m("",!0)],2)):m("",!0)]))}}),Mt=(I,B)=>{const n=I.__vccOpts||I;for(const[$,c]of B)n[$]=c;return n},zt=Mt(Ct,[["__scopeId","data-v-de71a751"]]),St={key:0,class:"absolute inset-0 opacity-10"},At={class:"relative z-10"},jt={class:"flex items-center justify-between mb-6"},Dt={class:"text-xl font-bold flex items-center space-x-3"},Bt={key:0,class:"text-2xl animate-bounce"},Lt={class:"text-right"},Et={class:"text-3xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent"},It={class:"flex items-center space-x-2 text-sm text-gray-300"},Rt={class:"font-medium"},Vt={key:0,class:"mb-6"},Nt={class:"text-sm font-medium text-gray-300 mb-3"},Ft={class:"flex space-x-3"},Ot=["title"],Xt={class:"flex items-center space-x-2"},Ht=["title"],Ut={class:"flex items-center space-x-2"},Yt={class:"mb-6"},qt={class:"text-lg font-semibold text-gray-200 mb-4 flex items-center"},Gt={key:0,class:"text-center py-12 text-gray-400"},Jt={class:"text-lg font-medium mb-2"},Zt={class:"p-8 border-2 border-dashed border-gray-500 rounded-2xl group-hover:border-purple-400 transition-colors duration-300 bg-gradient-to-br from-gray-800/30 to-gray-900/30 backdrop-blur-sm"},Kt={class:"text-center text-gray-300 font-medium"},Qt={key:1,class:"space-y-3"},Wt={class:"h-full border-2 border-dashed border-gray-600 rounded-xl group-hover:border-cyan-400 transition-colors duration-300 bg-gradient-to-r from-gray-800/20 to-gray-700/20 backdrop-blur-sm flex items-center justify-center"},eo={class:"text-center text-gray-400 text-sm font-medium"},to={class:"p-4 bg-gradient-to-r from-gray-800/60 to-gray-900/60 backdrop-blur-sm border border-gray-600/30 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-[1.02]"},oo={class:"flex items-center space-x-4"},ro={class:"w-16 h-16 rounded-xl overflow-hidden flex-shrink-0 relative group-hover:scale-105 transition-transform duration-300"},so=["src","alt"],ao={key:1,class:"w-16 h-16 bg-gradient-to-br from-gray-700 to-gray-800 flex items-center justify-center"},lo={class:"flex-1 min-w-0"},no={class:"font-bold text-lg text-gray-100 truncate"},io={class:"text-sm text-gray-300 truncate font-medium"},uo={class:"text-right flex-shrink-0"},co={class:"font-bold text-2xl bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent"},go=["onDragover","onDragleave","onDrop","data-drop-zone"],po={class:"h-full border-2 border-dashed border-gray-600 rounded-xl group-hover:border-purple-400 transition-colors duration-300 bg-gradient-to-r from-gray-800/20 to-gray-700/20 backdrop-blur-sm flex items-center justify-center"},vo={class:"text-center text-gray-400 text-sm font-medium"},mo=["data-drop-zone"],fo={class:"h-full border-2 border-dashed border-gray-600 rounded-xl group-hover:border-cyan-400 transition-colors duration-300 bg-gradient-to-r from-gray-800/20 to-gray-700/20 backdrop-blur-sm flex items-center justify-center"},ho={class:"text-center text-gray-400 text-sm font-medium"},bo={class:"flex items-center space-x-4"},yo={class:"flex-1 min-w-0"},xo={class:"font-bold text-lg text-blue-200"},ko={class:"text-sm text-blue-300 font-medium"},wo={key:2,class:"mt-6 pt-6 border-t border-gray-600/30"},$o={class:"flex justify-between text-sm text-gray-300"},_o={class:"font-medium"},To={key:0,class:"font-mono"},Po=ee({__name:"PlayerTimeline",props:{player:{},isCurrent:{type:Boolean},currentTrack:{},canPlace:{type:Boolean}},emits:["placeTrack","useToken"],setup(I,{emit:B}){const n=I,$=B,c=b(!1),p=b([]),_=b(!1),R=b({x:0,y:0}),x=b({x:0,y:0}),g=b(null),k=h(()=>{if(n.player.timeline.length<2)return null;const s=n.player.timeline.map(o=>o.year).sort((o,t)=>o-t);return`${s[0]} - ${s[s.length-1]}`});function M(s){var o,t,u,f;return((t=(o=s.images)==null?void 0:o[0])==null?void 0:t.url)||((f=(u=s.album.images)==null?void 0:u[0])==null?void 0:f.url)||"/placeholder-album.png"}function j(s){return s.artists.map(o=>o.name).join(", ")}function V(s){var t;if(!n.currentTrack)return;(t=s.dataTransfer)==null||t.setData("text/plain",JSON.stringify(n.currentTrack)),s.target.classList.add("dragging")}function Y(s){s.target.classList.remove("dragging"),c.value=!1,p.value=[]}function L(s){!n.currentTrack||!n.canPlace||(c.value=!1,p.value=[],$("placeTrack",n.currentTrack,s))}function N(s){$("useToken",s)}function F(s){if(!(!n.currentTrack||!n.canPlace))try{s.preventDefault(),_.value=!0;const o=s.touches[0];if(!o)return;R.value={x:o.clientX,y:o.clientY},x.value={x:o.clientX,y:o.clientY};const t=s.target,u=t.getBoundingClientRect();g.value=t.cloneNode(!0),g.value.style.position="fixed",g.value.style.top=`${u.top}px`,g.value.style.left=`${u.left}px`,g.value.style.width=`${u.width}px`,g.value.style.height=`${u.height}px`,g.value.style.zIndex="9999",g.value.style.opacity="0.8",g.value.style.transform="rotate(2deg)",g.value.style.pointerEvents="none",g.value.classList.add("dragging"),document.body.appendChild(g.value),t.classList.add("dragging"),"vibrate"in navigator&&navigator.vibrate(50)}catch(o){console.warn("Touch start error:",o),P()}}function S(s){if(!(!_.value||!g.value))try{s.preventDefault();const o=s.touches[0];if(!o)return;x.value={x:o.clientX,y:o.clientY};const t=50,u=50;g.value.style.left=`${o.clientX-t}px`,g.value.style.top=`${o.clientY-u}px`;const f=document.elementFromPoint(o.clientX,o.clientY),z=f==null?void 0:f.closest("[data-drop-zone]");if(c.value=!1,p.value.fill(!1),z){const E=parseInt(z.getAttribute("data-drop-zone")||"0");E===0?c.value=!0:E<=p.value.length&&(p.value[E]=!0)}}catch(o){console.warn("Touch move error:",o)}}function O(s){if(_.value)try{s.preventDefault(),_.value=!1;const o=s.changedTouches[0];if(!o){P();return}const t=document.elementFromPoint(o.clientX,o.clientY),u=t==null?void 0:t.closest("[data-drop-zone]");g.value&&(g.value.style.transition="opacity 0.2s ease-out",g.value.style.opacity="0",setTimeout(()=>{g.value&&document.body.contains(g.value)&&document.body.removeChild(g.value),g.value=null},200));const f=document.querySelector(".dragging");if(f&&f.classList.remove("dragging"),c.value=!1,p.value.fill(!1),u&&n.currentTrack){const z=parseInt(u.getAttribute("data-drop-zone")||"0");"vibrate"in navigator&&navigator.vibrate(100),$("placeTrack",n.currentTrack,z)}}catch(o){console.warn("Touch end error:",o),P()}}function T(){p.value=new Array(n.player.timeline.length+1).fill(!1)}function P(){_.value=!1,c.value=!1,p.value.fill(!1),g.value&&document.body.contains(g.value)&&(document.body.removeChild(g.value),g.value=null),document.querySelectorAll(".dragging").forEach(o=>o.classList.remove("dragging"))}return te(()=>{P()}),Z(()=>n.player.timeline.length,()=>{T()},{immediate:!0}),(s,o)=>(i(),d("div",{class:D(["card relative overflow-hidden",{"ring-2 ring-cyan-400 shadow-2xl shadow-cyan-400/20":s.isCurrent}])},[s.isCurrent?(i(),d("div",St,o[11]||(o[11]=[e("div",{class:"absolute top-0 left-0 w-64 h-64 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full blur-3xl animate-pulse"},null,-1),e("div",{class:"absolute bottom-0 right-0 w-80 h-80 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full blur-3xl animate-pulse delay-1000"},null,-1)]))):m("",!0),e("div",At,[e("div",jt,[e("h3",Dt,[e("span",{class:D(s.isCurrent?"bg-gradient-to-r from-cyan-300 to-blue-300 bg-clip-text text-transparent":"text-gray-200")},a(s.player.name),3),s.isCurrent?(i(),d("span",Bt,"üëë")):m("",!0)]),e("div",Lt,[e("p",Et,a(s.player.score),1),e("div",It,[o[12]||(o[12]=e("span",{class:"text-lg"},"üéµ",-1)),e("span",Rt,a(s.$t("game.score.tokens",{count:s.player.tokens})),1)])])]),s.isCurrent&&s.canPlace&&s.player.tokens>0?(i(),d("div",Vt,[e("h4",Nt,a(s.$t("game.tokenAbilities")),1),e("div",Ft,[e("button",{onClick:o[0]||(o[0]=t=>N("skip")),class:"group relative px-4 py-2 bg-gradient-to-r from-orange-600 to-pink-600 hover:from-orange-500 hover:to-pink-500 text-white rounded-xl font-medium transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-orange-500/25",title:s.$t("game.tokens.skip.description")},[e("div",Xt,[o[13]||(o[13]=e("span",{class:"text-lg"},"‚è≠Ô∏è",-1)),e("span",null,a(s.$t("game.tokens.skip.label")),1)])],8,Ot),e("button",{onClick:o[1]||(o[1]=t=>N("hint")),class:"group relative px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-xl font-medium transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-cyan-500/25",title:s.$t("game.tokens.hint.description")},[e("div",Ut,[o[14]||(o[14]=e("span",{class:"text-lg"},"üí°",-1)),e("span",null,a(s.$t("game.tokens.hint.label")),1)])],8,Ht)])])):m("",!0),e("div",Yt,[e("h4",qt,[o[15]||(o[15]=e("span",{class:"mr-2"},"üéµ",-1)),K(" "+a(s.$t("game.timeline.title")),1)]),s.player.timeline.length===0?(i(),d("div",Gt,[o[16]||(o[16]=e("div",{class:"mb-4"},[e("div",{class:"w-20 h-20 mx-auto bg-gradient-to-br from-gray-700 to-gray-800 rounded-full flex items-center justify-center shadow-lg"},[e("span",{class:"text-3xl"},"üéº")])],-1)),e("p",Jt,a(s.$t("game.timeline.empty")),1),s.canPlace?(i(),d("div",{key:0,class:D(["timeline-slot mt-6 group",{"drag-over":c.value}]),onDragover:o[2]||(o[2]=C(t=>c.value=!0,["prevent"])),onDragleave:o[3]||(o[3]=C(t=>c.value=!1,["prevent"])),onDrop:o[4]||(o[4]=C(t=>L(0),["prevent"])),"data-drop-zone":0},[e("div",Zt,[e("p",Kt,a(s.$t("game.timeline.placeHere")),1)])],34)):m("",!0)])):(i(),d("div",Qt,[s.canPlace?(i(),d("div",{key:0,class:D(["timeline-slot h-20 group",{"drag-over":p.value[0]}]),onDragover:o[5]||(o[5]=C(t=>p.value[0]=!0,["prevent"])),onDragleave:o[6]||(o[6]=C(t=>p.value[0]=!1,["prevent"])),onDrop:o[7]||(o[7]=C(t=>L(0),["prevent"])),"data-drop-zone":0},[e("div",Wt,[e("p",eo,a(s.$t("game.placeEarlier")),1)])],34)):m("",!0),(i(!0),d(Q,null,W(s.player.timeline,(t,u)=>(i(),d("div",{key:t.id,class:"track-card group relative"},[e("div",to,[e("div",oo,[e("div",ro,[t.revealed?(i(),d("img",{key:0,src:M(t),alt:t.name,class:"w-16 h-16 object-cover"},null,8,so)):(i(),d("div",ao,o[17]||(o[17]=[e("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})],-1)])))]),e("div",lo,[e("p",no,a(t.name),1),e("p",io,a(j(t)),1)]),e("div",uo,[e("p",co,a(t.year),1)])])]),s.canPlace&&u<s.player.timeline.length-1?(i(),d("div",{key:0,class:D(["timeline-slot h-20 mt-3 group",{"drag-over":p.value[u+1]}]),onDragover:C(f=>p.value[u+1]=!0,["prevent"]),onDragleave:C(f=>p.value[u+1]=!1,["prevent"]),onDrop:C(f=>L(u+1),["prevent"]),"data-drop-zone":u+1},[e("div",po,[e("p",vo,a(s.$t("game.placeBetween")),1)])],42,go)):m("",!0)]))),128)),s.canPlace?(i(),d("div",{key:1,class:D(["timeline-slot h-20 group",{"drag-over":p.value[s.player.timeline.length]}]),onDragover:o[8]||(o[8]=C(t=>p.value[s.player.timeline.length]=!0,["prevent"])),onDragleave:o[9]||(o[9]=C(t=>p.value[s.player.timeline.length]=!1,["prevent"])),onDrop:o[10]||(o[10]=C(t=>L(s.player.timeline.length),["prevent"])),"data-drop-zone":s.player.timeline.length},[e("div",fo,[e("p",ho,a(s.$t("game.placeLater")),1)])],42,mo)):m("",!0)]))]),s.canPlace&&s.currentTrack?(i(),d("div",{key:1,class:"p-6 bg-gradient-to-r from-blue-900/50 to-purple-900/50 border-2 border-blue-400/30 rounded-2xl cursor-move touch-manipulation select-none backdrop-blur-sm shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-[1.02]",draggable:"true",onDragstart:V,onDragend:Y,onTouchstart:F,onTouchmove:S,onTouchend:O,style:{touchAction:"none"}},[e("div",bo,[o[18]||(o[18]=e("div",{class:"w-16 h-16 rounded-xl bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center flex-shrink-0 shadow-lg"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})])],-1)),e("div",yo,[e("p",xo,a(s.$t("game.newTrack")),1),e("p",ko,a(s.$t("game.dragToPlace")),1)]),o[19]||(o[19]=e("div",{class:"text-blue-300"},[e("span",{class:"text-3xl animate-pulse"},"üéµ")],-1))])],32)):m("",!0),s.player.timeline.length>0?(i(),d("div",wo,[e("div",$o,[e("span",_o,a(s.$t("game.tracksInTimeline",{count:s.player.timeline.length})),1),k.value?(i(),d("span",To,a(k.value),1)):m("",!0)])])):m("",!0)])],2))}}),Co={class:"min-h-screen flex flex-col"},Mo={class:"bg-white/10 backdrop-blur-sm p-4"},zo={class:"flex justify-between items-center"},So={class:"flex items-center space-x-4"},Ao={class:"text-white"},jo={class:"text-xl font-bold"},Do={class:"text-sm opacity-80"},Bo={class:"text-white text-right"},Lo={class:"text-sm opacity-80"},Eo={class:"flex-1 container mx-auto px-4 py-6"},Io={key:0,class:"max-w-2xl mx-auto"},Ro={class:"card text-center"},Vo={class:"text-2xl font-semibold mb-4"},No={class:"text-gray-600 mb-6"},Fo={key:1,class:"space-y-6"},Oo={class:"card text-center bg-green-50 border-green-200"},Xo={class:"text-2xl font-bold text-green-800 mb-2"},Ho={class:"text-green-700"},Uo={key:0,class:"mt-4"},Yo={key:1,class:"mt-4"},qo={class:"flex items-center justify-center space-x-2"},Go={key:0,class:"card bg-yellow-50 border-yellow-200"},Jo={class:"flex items-center space-x-3"},Zo={class:"flex-1"},Ko={class:"text-lg font-semibold text-yellow-800"},Qo={class:"text-yellow-700 text-sm"},Wo={class:"flex space-x-2"},er={key:1,class:"card bg-orange-50 border-orange-200"},tr={key:3,class:"max-w-4xl mx-auto"},or={class:"card"},rr={class:"text-lg font-semibold mb-4"},sr={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},ar={class:"font-semibold"},lr={class:"text-2xl font-bold text-green-600"},nr={class:"text-sm text-gray-600"},ir={class:"text-xs text-gray-500"},ur={key:2,class:"max-w-2xl mx-auto"},dr={class:"card text-center"},cr={class:"text-3xl font-bold mb-4 text-green-600"},gr={class:"text-xl mb-6"},pr={class:"mb-6"},vr={class:"text-lg font-semibold mb-3"},mr={class:"space-y-2"},fr={class:"font-medium"},hr={class:"font-bold"},br={class:"flex space-x-4 justify-center"},yr={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},xr={class:"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 border border-purple-500/20 shadow-2xl shadow-purple-500/10 rounded-2xl p-8 max-w-md w-full mx-auto relative overflow-hidden"},kr={class:"relative z-10"},wr={class:"flex items-center space-x-3 mb-6"},$r={class:"text-2xl font-bold bg-gradient-to-r from-cyan-300 to-blue-300 bg-clip-text text-transparent"},_r={class:"mb-8"},Tr={class:"text-gray-200 text-lg leading-relaxed"},Pr={class:"flex justify-center"},Mr=ee({__name:"GameView",setup(I){const B=fe(),n=me(),$=b(!1),c=b(w.isAuthenticated()),p=b(!1),_=b(""),R=h(()=>n.players),x=h(()=>n.currentPlayer),g=h(()=>n.currentTrack),k=h(()=>n.gamePhase),M=h(()=>n.round);h(()=>n.settings);const j=h(()=>n.winner),V=h(()=>c.value),Y=h(()=>V.value&&!w.isPlayerReady()),L=h(()=>[...R.value].sort((t,u)=>u.timeline.length!==t.timeline.length?u.timeline.length-t.timeline.length:u.tokens!==t.tokens?u.tokens-t.tokens:u.score-t.score));async function N(){$.value=!0;try{await n.getNextTrack()||console.error("No tracks available")}catch(t){console.error("Error loading track:",t)}finally{$.value=!1}}function F(t,u){n.placeTrackOnTimeline(t,u),setTimeout(()=>{n.nextPlayer()},2e3)}function S(t){var f;if(!x.value)return;if(n.useToken(x.value.id,t))switch(t){case"skip":N();break;case"hint":const z=Math.floor(((f=g.value)==null?void 0:f.year)/10)*10;_.value=`This track was released in the ${z}s`,p.value=!0;break}}function O(){p.value=!1,_.value=""}function T(){n.resetGame(),B.push("/")}function P(){B.push("/")}function s(){const t=w.isAuthenticated(),u=localStorage.getItem("spotify_auth");console.log("Spotify auth check:",{isAuthenticated:t,authStateInStorage:u?JSON.parse(u):null,currentValue:c.value}),c.value=t,t&&w.initializePlayerIfReady()}async function o(){console.log("üîÑ Re-authorizing Spotify with updated permissions"),await w.forceReauth()}return ae(()=>{n.gamePhase==="setup"&&n.players.length===0&&B.push("/"),s();const t=setInterval(()=>{s()},2e3);te(()=>{clearInterval(t)})}),(t,u)=>{var f,z,E,H;return i(),d("div",Co,[e("header",Mo,[e("div",zo,[e("div",So,[e("button",{onClick:u[0]||(u[0]=y=>t.$router.push("/")),class:"btn btn-secondary"}," ‚Üê "+a(t.$t("common.back")),1),e("div",Ao,[e("h1",jo,a(t.$t("game.title")),1),e("p",Do,a(t.$t("game.round"))+" "+a(M.value),1)])]),e("div",Bo,[e("p",Lo,a(t.$t("game.turn.currentPlayer",{player:(f=x.value)==null?void 0:f.name})),1)])])]),e("main",Eo,[k.value==="setup"?(i(),d("div",Io,[e("div",Ro,[e("h2",Vo,a(t.$t("game.setupRequired")),1),e("p",No,a(t.$t("game.setupMessage")),1),e("button",{onClick:u[1]||(u[1]=y=>t.$router.push("/")),class:"btn btn-primary"},a(t.$t("game.backToSetup")),1)])])):k.value==="playing"?(i(),d("div",Fo,[e("div",Oo,[e("h2",Xo,a(t.$t("game.turn.currentPlayer",{player:(z=x.value)==null?void 0:z.name})),1),e("p",Ho,a(t.$t("game.turn.ready")),1),!g.value&&!$.value?(i(),d("div",Uo,[e("button",{onClick:N,class:"btn btn-primary btn-lg"}," üéµ "+a(t.$t("game.getTrack")),1)])):m("",!0),$.value?(i(),d("div",Yo,[e("div",qo,[u[3]||(u[3]=e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-green-500"},null,-1)),e("span",null,a(t.$t("common.loading")),1)])])):m("",!0)]),V.value?V.value&&Y.value?(i(),d("div",er,[e("div",{class:"flex items-center space-x-3"},[u[5]||(u[5]=le('<div class="flex-shrink-0"><svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"></path></svg></div><div class="flex-1"><h3 class="text-lg font-semibold text-orange-800">Playback Permissions Needed</h3><p class="text-orange-700 text-sm">Your Spotify connection needs updated permissions to play music.</p></div>',2)),e("div",{class:"flex space-x-2"},[e("button",{onClick:o,class:"btn btn-sm bg-orange-600 hover:bg-orange-700 text-white"}," üîê Update Permissions ")])])])):m("",!0):(i(),d("div",Go,[e("div",Jo,[u[4]||(u[4]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 18.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("div",Zo,[e("h3",Ko,a(t.$t("game.spotify.notConnected")),1),e("p",Qo,a(t.$t("game.demoModeActive")),1)]),e("div",Wo,[e("button",{onClick:P,class:"btn btn-sm bg-yellow-600 hover:bg-yellow-700 text-white"},a(t.$t("game.spotify.login")),1),e("button",{onClick:o,class:"btn btn-sm bg-purple-600 hover:bg-purple-700 text-white"}," üîê Re-auth "),e("button",{onClick:s,class:"btn btn-sm bg-blue-600 hover:bg-blue-700 text-white"}," üîÑ Refresh ")])])])),g.value?(i(),he(zt,{key:2,track:g.value,onPlaceTrack:F},null,8,["track"])):m("",!0),x.value?(i(),d("div",tr,[be(Po,{player:x.value,"is-current":!0,"current-track":g.value,"can-place":!!g.value,onPlaceTrack:F,onUseToken:S},null,8,["player","current-track","can-place"])])):m("",!0),e("div",or,[e("h3",rr,a(t.$t("game.score.title")),1),e("div",sr,[(i(!0),d(Q,null,W(R.value,y=>{var X;return i(),d("div",{key:y.id,class:D(["text-center p-3 rounded-lg",y.id===((X=x.value)==null?void 0:X.id)?"bg-green-100":"bg-gray-50"])},[e("p",ar,a(y.name),1),e("p",lr,a(y.tokens),1),e("p",nr,a(t.$t("game.score.tokens",{count:y.tokens})),1),e("p",ir,a(t.$t("game.score.total",{score:y.score})),1)],2)}),128))])])])):k.value==="finished"?(i(),d("div",ur,[e("div",dr,[e("h2",cr,a(t.$t("game.end.title")),1),e("p",gr,a(t.$t("game.end.winner",{player:(E=j.value)==null?void 0:E.name,score:(H=j.value)==null?void 0:H.timeline.length})),1),e("div",pr,[e("h3",vr,a(t.$t("game.end.finalScores")),1),e("div",mr,[(i(!0),d(Q,null,W(L.value,(y,X)=>(i(),d("div",{key:y.id,class:D(["flex justify-between items-center p-3 rounded-lg",X===0?"bg-yellow-100":"bg-gray-50"])},[e("span",fr,a(X+1)+". "+a(y.name),1),e("span",hr,a(y.timeline.length)+" "+a(t.$t("game.songs"))+" | "+a(y.tokens)+" "+a(t.$t("game.score.tokens",{count:y.tokens})),1)],2))),128))])]),e("div",br,[e("button",{onClick:T,class:"btn btn-primary"}," üîÑ "+a(t.$t("game.end.playAgain")),1),e("button",{onClick:u[2]||(u[2]=y=>t.$router.push("/")),class:"btn btn-secondary"}," üè† "+a(t.$t("game.backToHome")),1)])])])):m("",!0)]),p.value?(i(),d("div",yr,[e("div",xr,[u[7]||(u[7]=e("div",{class:"absolute inset-0 opacity-10"},[e("div",{class:"absolute top-0 left-0 w-32 h-32 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full blur-3xl animate-pulse"}),e("div",{class:"absolute bottom-0 right-0 w-40 h-40 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full blur-3xl animate-pulse delay-1000"})],-1)),e("div",kr,[e("div",wr,[u[6]||(u[6]=e("div",{class:"w-12 h-12 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg"},[e("span",{class:"text-2xl"},"üí°")],-1)),e("h3",$r,a(t.$t("game.tokens.hint.label")),1)]),e("div",_r,[e("p",Tr,a(_.value),1)]),e("div",Pr,[e("button",{onClick:O,class:"px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white font-bold rounded-xl transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-purple-500/25"},a(t.$t("common.close")),1)])])])])):m("",!0)])}}});export{Mr as default};
