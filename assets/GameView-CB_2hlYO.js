import{d as le,n as ce,r as h,c as P,s as S,o as se,a as K,p as ie,w as ne,b as i,e,f as b,q as ue,t as s,g as de,x as R,l as n,h as j,F as re,j as ae,u as ge,k as me,y as ve,z as pe}from"./index-I2PLEAFt.js";const fe={class:"card relative overflow-hidden border border-purple-500/20 shadow-2xl shadow-purple-500/10"},he={class:"relative z-10 flex flex-col md:flex-row items-start space-y-4 md:space-y-0 md:space-x-6 p-4"},be={class:"flex-shrink-0"},ye={key:0,class:"relative group"},ke={key:1,class:"relative group"},xe=["src","alt"],we={class:"flex-1 text-center md:text-left"},$e={class:"mb-3"},_e={class:"text-gray-300 font-medium text-base bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent"},Te={class:"text-xs text-gray-400 mt-1 font-light"},Pe={class:"mb-3"},Ce={key:0,class:"bg-gradient-to-r from-green-900/30 to-emerald-900/30 border border-green-400/30 rounded-xl p-4 text-center backdrop-blur-sm"},Se={class:"flex items-center justify-center mb-2"},ze={class:"text-sm font-bold bg-gradient-to-r from-green-300 to-emerald-300 bg-clip-text text-transparent"},Me={class:"text-green-200 text-xs"},je={key:1,class:"bg-gradient-to-r from-blue-900/30 to-purple-900/30 border border-blue-400/30 rounded-xl p-4 text-center backdrop-blur-sm"},Ae={class:"flex items-center justify-center mb-2"},De={class:"text-sm font-bold bg-gradient-to-r from-blue-300 to-purple-300 bg-clip-text text-transparent"},Be={class:"text-blue-200 text-xs"},Ie={key:2,class:"music-player-controls bg-gradient-to-br from-gray-900/40 to-purple-900/40 rounded-xl p-4 backdrop-blur-sm border border-gray-700/30 shadow-lg"},Re={class:"flex items-center justify-center space-x-4 mb-3"},Le=["disabled"],Ee={class:"w-12 h-12 bg-gradient-to-br from-purple-600 to-pink-600 rounded-full flex items-center justify-center shadow-xl shadow-purple-500/30 group-hover:from-purple-500 group-hover:to-pink-500 transition-all duration-300 group-hover:scale-110 group-hover:shadow-purple-400/40"},Ne={key:0,class:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"},Fe={key:1,class:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 20 20"},Oe={key:2,class:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 20 20"},Ve={key:0,class:"p-4 bg-gradient-to-r from-blue-900/40 to-purple-900/40 border border-blue-400/30 rounded-xl backdrop-blur-sm"},Ue={class:"text-center"},Ye={class:"text-lg font-bold bg-gradient-to-r from-blue-300 to-purple-300 bg-clip-text text-transparent mb-1"},Xe={class:"text-blue-200 text-sm font-medium mb-1"},qe={class:"text-blue-300 text-sm font-medium"},He={class:"text-sm text-blue-400 mt-3"},Ge=["href"],We={key:0,class:"mt-3 p-3 bg-gradient-to-r from-purple-900/30 to-pink-900/30 border border-purple-400/30 rounded-xl backdrop-blur-sm"},Ze={class:"text-center"},Je={class:"flex items-center justify-center mb-2"},Ke={class:"font-bold text-sm bg-gradient-to-r from-purple-300 to-pink-300 bg-clip-text text-transparent"},Qe={class:"text-purple-200 text-xs font-medium"},et={class:"flex items-center justify-center mb-2"},tt={key:0,class:"w-8 h-8 bg-gradient-to-br from-cyan-500 to-blue-500 rounded-full flex items-center justify-center mr-2 animate-bounce"},ot={key:1,class:"w-8 h-8 bg-gradient-to-br from-red-500 to-pink-500 rounded-full flex items-center justify-center mr-2 animate-pulse"},st={class:"font-bold text-lg"},rt={key:0,class:"text-sm mt-1 font-semibold"},at={class:"bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent"},lt=le({__name:"TrackPlayer",props:{track:{},showAnswer:{type:Boolean,default:!1},showResult:{type:Boolean,default:!1},isCorrect:{type:Boolean,default:!1},pointsEarned:{default:0}},emits:["placeTrack"],setup(X,{emit:F}){const a=X,{t:B}=ce(),v=h(!1),x=h(!1);h(!1);const _=h(0),A=h(0);h(.7),h(!1),h(!1),h(!1);const D=P(()=>{var M,$,C,N;const l=($=(M=a.track.images)==null?void 0:M[0])==null?void 0:$.url,u=(N=(C=a.track.album.images)==null?void 0:C[0])==null?void 0:N.url;return l||u||"https://via.placeholder.com/300x300/6B7280/FFFFFF?text=No+Image"}),q=P(()=>a.track.artists.map(l=>l.name).join(", ")),L=P(()=>a.showResult?a.isCorrect?"bg-gradient-to-r from-cyan-900/40 to-blue-900/40 border border-cyan-400/30 text-cyan-100":"bg-gradient-to-r from-red-900/40 to-pink-900/40 border border-red-400/30 text-red-100":""),c=P(()=>a.showResult?a.isCorrect?B("game.turn.correct",{year:a.track.year}):B("game.turn.incorrect",{year:a.track.year}):"");P(()=>A.value===0?0:_.value/A.value*100);const y=P(()=>!!a.track.uri),w=P(()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|CriOS/i.test(navigator.userAgent)),z=P(()=>w.value?y.value&&S.isAuthenticated():y.value&&S.isPlayerReady()),f=P(()=>z.value||!!a.track.preview_url);async function O(){try{z.value&&a.track.uri&&(v.value?await S.pausePlayback()&&(v.value=!1):await S.startPlayback(a.track.uri)&&(v.value=!0,w.value?G():V()))}catch(l){console.error("Playback error:",l),w.value&&l.message.includes("No active Spotify device")&&alert("Please open the Spotify app on your device first, then try again.")}}function G(){const l=async()=>{var M;if(!z.value||!w.value)return;const u=await S.getSpotifyConnectState();if(u){const $=((M=u.item)==null?void 0:M.uri)===a.track.uri,C=u.is_playing&&$;v.value!==C&&(v.value=C),v.value&&setTimeout(l,2e3)}else v.value&&(v.value=!1)};l()}function V(){const l=async()=>{if(!z.value)return;const u=await S.getPlaybackState();u&&(v.value=!u.paused,_.value=u.position/1e3,A.value=u.duration/1e3,v.value&&setTimeout(l,1e3))};l()}async function Z(){var l,u,M,$;if(S.isPlayerReady())try{const C=await S.getPlaybackState();if(C){const N=((u=(l=C.track_window)==null?void 0:l.current_track)==null?void 0:u.uri)===a.track.uri,U=C.paused===!1&&N;console.log("Playback state check:",{paused:C.paused,currentTrackUri:($=(M=C.track_window)==null?void 0:M.current_track)==null?void 0:$.uri,expectedUri:a.track.uri,isCurrentTrack:N,isActuallyPlaying:U,componentIsPlaying:v.value}),v.value!==U&&(console.log(`🔄 Syncing playback state: ${v.value} → ${U}`),v.value=U)}}catch(C){console.warn("Could not check playback state:",C)}}return se(()=>{const l=setInterval(Z,2e3);K(()=>{clearInterval(l)})}),se(()=>{S.isAuthenticated()&&ie(()=>{S.initializePlayerIfReady()})}),ne(()=>a.track,async(l,u)=>{if(l&&l!==u){console.log("New track detected:",l.name),await ie(),v.value=!1;const M=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|CriOS/i.test(navigator.userAgent);setTimeout(async()=>{if(console.log("Checking if auto-playback can start:",{canPlayAudio:f.value,canPlayFullTrack:z.value,hasSpotifyUri:y.value,isPlayerReady:S.isPlayerReady(),isPlaying:v.value}),f.value&&!v.value){console.log("Auto-starting playback for new track:",l.name);try{await O(),console.log("✅ Auto-playback started successfully")}catch($){M?console.log("🔇 Auto-playback blocked on mobile - user interaction required"):console.error("❌ Auto-playback failed:",$)}}else{const $=f.value?"Already playing":"No audio source available";console.log(`Cannot auto-start playback: ${$}`),!M&&y.value&&console.log("Has Spotify URI - playback will use Spotify Web Playback SDK")}},300)}},{immediate:!1}),K(()=>{z.value&&S.stopPlayback()}),(l,u)=>(n(),i("div",fe,[u[10]||(u[10]=e("div",{class:"absolute inset-0 opacity-10"},[e("div",{class:"absolute top-0 left-0 w-72 h-72 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full blur-3xl animate-pulse"}),e("div",{class:"absolute bottom-0 right-0 w-96 h-96 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full blur-3xl animate-pulse delay-1000"})],-1)),e("div",he,[e("div",be,[l.showAnswer?(n(),i("div",ke,[e("img",{src:D.value,alt:l.track.name,class:"w-24 h-24 rounded-xl shadow-xl object-cover border border-gray-700/50 backdrop-blur-sm transform group-hover:scale-105 transition-transform duration-300"},null,8,xe),u[1]||(u[1]=e("div",{class:"absolute inset-0 w-24 h-24 rounded-xl bg-gradient-to-br from-cyan-500/20 to-blue-500/20 blur-xl group-hover:blur-2xl transition-all duration-300"},null,-1))])):(n(),i("div",ye,u[0]||(u[0]=[ue('<div class="w-24 h-24 rounded-xl shadow-xl bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center border border-gray-700/50 backdrop-blur-sm" data-v-2955d9f1><div class="w-20 h-20 rounded-full bg-gradient-to-br from-gray-900 to-gray-800 shadow-inner flex items-center justify-center" data-v-2955d9f1><div class="w-12 h-12 rounded-full bg-gradient-to-br from-gray-800 to-gray-900 shadow-inner flex items-center justify-center" data-v-2955d9f1><svg class="w-6 h-6 text-gray-400 animate-spin-slow" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-2955d9f1><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3" data-v-2955d9f1></path></svg></div></div></div><div class="absolute inset-0 w-24 h-24 rounded-xl bg-gradient-to-br from-purple-500/20 to-pink-500/20 blur-xl group-hover:blur-2xl transition-all duration-300" data-v-2955d9f1></div>',2)])))]),e("div",we,[e("div",$e,[e("p",_e,s(l.$t("game.turn.listening")),1),e("p",Te,s(l.$t("game.turn.placeOnTimeline")),1)]),e("div",Pe,[!f.value&&w.value&&y.value?(n(),i("div",Ce,[e("div",Se,[u[2]||(u[2]=e("div",{class:"w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center mr-2 shadow-lg"},[e("svg",{class:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"})])],-1)),e("h3",ze,s(l.$t("game.spotifyConnect.title","Spotify Connect")),1)]),e("p",Me,s(l.$t("game.spotifyConnect.description","Music will play through your Spotify app")),1)])):z.value?b("",!0):(n(),i("div",je,[e("div",Ae,[u[3]||(u[3]=e("div",{class:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mr-2 shadow-lg"},[e("svg",{class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})])],-1)),e("h3",De,s(y.value?l.$t("game.premiumRequired"):l.$t("game.demoMode")),1)]),e("p",Be,s(y.value?l.$t("game.needsPremium"):l.$t("game.needSpotifyForAudio")),1)])),f.value?(n(),i("div",Ie,[e("div",Re,[e("button",{onClick:O,class:"play-btn group relative",disabled:!f.value},[e("div",Ee,[x.value?(n(),i("div",Ne)):v.value?(n(),i("svg",Fe,u[4]||(u[4]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(n(),i("svg",Oe,u[5]||(u[5]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"},null,-1)])))])],8,Le)])])):b("",!0)]),l.showAnswer?(n(),i("div",Ve,[e("div",Ue,[e("h4",Ye,s(l.track.name),1),e("p",Xe,s(q.value),1),e("p",qe,s(l.track.album.name)+" ("+s(l.track.year)+")",1),e("p",He,[e("a",{href:l.track.external_urls.spotify,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center px-3 py-1 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-full hover:from-green-500 hover:to-green-400 transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-green-500/25 text-xs"},[u[6]||(u[6]=e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"})],-1)),de(" "+s(l.$t("game.openInSpotify")),1)],8,Ge)])])])):b("",!0)])]),l.showAnswer?b("",!0):(n(),i("div",We,[e("div",Ze,[e("div",Je,[u[7]||(u[7]=e("div",{class:"w-6 h-6 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center mr-2 animate-pulse"},[e("svg",{class:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("p",Ke,s(l.$t("game.turn.placing")),1)]),e("p",Qe,s(w.value?l.$t("game.timeline.mobileInstructions"):l.$t("game.dragToTimeline")),1)])])),l.showResult?(n(),i("div",{key:1,class:R(["mt-3 p-4 rounded-xl text-center backdrop-blur-sm",L.value])},[e("div",et,[l.isCorrect?(n(),i("div",tt,u[8]||(u[8]=[e("svg",{class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]))):(n(),i("div",ot,u[9]||(u[9]=[e("svg",{class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))),e("p",st,s(c.value),1)]),l.pointsEarned>0?(n(),i("p",rt,[e("span",at,s(l.$t("game.turn.points",{points:l.pointsEarned})),1)])):b("",!0)],2)):b("",!0)]))}}),nt=(X,F)=>{const a=X.__vccOpts||X;for(const[B,v]of F)a[B]=v;return a},it=nt(lt,[["__scopeId","data-v-2955d9f1"]]),ut={key:0,class:"absolute inset-0 opacity-10"},dt={class:"relative z-10"},ct={class:"flex items-center justify-between mb-6"},gt={class:"text-xl font-bold flex items-center space-x-3"},mt={key:0,class:"text-2xl animate-bounce"},vt={class:"text-right"},pt={class:"text-3xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent"},ft={class:"flex items-center space-x-2 text-sm text-gray-300"},ht={class:"font-medium"},bt={key:0,class:"mb-6"},yt={class:"text-sm font-medium text-gray-300 mb-3"},kt={class:"flex space-x-3"},xt=["title"],wt={class:"flex items-center space-x-2"},$t=["title"],_t={class:"flex items-center space-x-2"},Tt={class:"mb-6"},Pt={class:"text-lg font-semibold text-gray-200 mb-4 flex items-center"},Ct={key:0,class:"text-center py-12 text-gray-400"},St={class:"text-lg font-medium mb-2"},zt={class:"text-center text-gray-300 font-medium"},Mt={key:1,class:"space-y-3"},jt={class:"text-center text-gray-400 text-sm font-medium"},At={class:"p-4 bg-gradient-to-r from-gray-800/60 to-gray-900/60 backdrop-blur-sm border border-gray-600/30 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-[1.02]"},Dt={class:"flex items-center space-x-4"},Bt={class:"w-16 h-16 rounded-xl overflow-hidden flex-shrink-0 relative group-hover:scale-105 transition-transform duration-300"},It=["src","alt"],Rt={key:1,class:"w-16 h-16 bg-gradient-to-br from-gray-700 to-gray-800 flex items-center justify-center"},Lt={class:"flex-1 min-w-0"},Et={class:"font-bold text-lg text-gray-100 truncate"},Nt={class:"text-sm text-gray-300 truncate font-medium"},Ft={class:"text-right flex-shrink-0"},Ot={class:"font-bold text-2xl bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent"},Vt=["onDragover","onDragleave","onDrop","onTouchstart","onClick","data-drop-zone"],Ut={class:"text-center text-gray-400 text-sm font-medium"},Yt=["data-drop-zone"],Xt={class:"text-center text-gray-400 text-sm font-medium"},qt={class:"flex items-center space-x-4"},Ht={class:"flex-1 min-w-0"},Gt={class:"font-bold text-lg text-blue-200"},Wt={class:"text-sm text-blue-300 font-medium"},Zt={key:2,class:"mt-6 pt-6 border-t border-gray-600/30"},Jt={class:"flex justify-between text-sm text-gray-300"},Kt={class:"font-medium"},Qt={key:0,class:"font-mono"},eo={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},to={class:"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 border border-purple-500/20 shadow-2xl shadow-purple-500/10 rounded-2xl p-6 max-w-sm w-full mx-auto relative overflow-hidden"},oo={class:"relative z-10"},so={class:"flex items-center space-x-3 mb-4"},ro={class:"text-xl font-bold bg-gradient-to-r from-green-300 to-blue-300 bg-clip-text text-transparent"},ao={class:"mb-6"},lo={class:"text-gray-200 text-lg leading-relaxed"},no={class:"flex space-x-3"},io=le({__name:"PlayerTimeline",props:{player:{},isCurrent:{type:Boolean},currentTrack:{},canPlace:{type:Boolean}},emits:["placeTrack","useToken"],setup(X,{emit:F}){const a=X,B=F,v=h(!1),x=h([]),_=h(null),A=h(!1),D=h(!1),q=h({x:0,y:0}),L=h({x:0,y:0}),c=h(null),y=h({x:0,y:0}),w=h(null);let z=null;const f=P(()=>"ontouchstart"in window||navigator.maxTouchPoints>0),O=P(()=>{var m;const t=((m=a.player)==null?void 0:m.timeline)||[];if(t.length<2)return null;const o=t.map(k=>k.year).sort((k,I)=>k-I);return`${o[0]} - ${o[o.length-1]}`});function G(t){var o,m;return t.images&&t.images.length>0&&((o=t.images[0])!=null&&o.url)?t.images[0].url:t.album&&t.album.images&&t.album.images.length>0&&((m=t.album.images[0])!=null&&m.url)?t.album.images[0].url:"/placeholder-album.png"}function V(t){return t.artists.map(o=>o.name).join(", ")}function Z(t){var m;if(!a.currentTrack)return;(m=t.dataTransfer)==null||m.setData("text/plain",JSON.stringify(a.currentTrack)),t.target.classList.add("dragging")}function l(t){t.target.classList.remove("dragging"),v.value=!1,x.value=[]}function u(t){!a.currentTrack||!a.canPlace||(v.value=!1,x.value=[],B("placeTrack",a.currentTrack,t))}function M(t){B("useToken",t)}function $(t){!a.currentTrack||!a.canPlace||(_.value=t,A.value=!0,"vibrate"in navigator&&navigator.vibrate(50))}function C(t){var k;if(t===null)return"";const o=((k=a.player)==null?void 0:k.timeline)||[],m=o.length;return t===0?m===0?"Place as your first track":`Place before ${o[0].name} (${o[0].year})`:t===m?`Place after ${o[m-1].name} (${o[m-1].year})`:`Place between ${o[t-1].name} (${o[t-1].year}) and ${o[t].name} (${o[t].year})`}function N(){_.value!==null&&a.currentTrack&&(B("placeTrack",a.currentTrack,_.value),_.value=null,A.value=!1)}function U(){_.value=null,A.value=!1}function Q(t){if(!(!a.currentTrack||!a.canPlace))try{t.preventDefault(),D.value=!0;const o=t.touches[0];if(!o)return;q.value={x:o.clientX,y:o.clientY},L.value={x:o.clientX,y:o.clientY};const m=t.target,k=m.getBoundingClientRect();c.value=m.cloneNode(!0),c.value.style.position="fixed",c.value.style.top=`${k.top}px`,c.value.style.left=`${k.left}px`,c.value.style.width=`${k.width}px`,c.value.style.height=`${k.height}px`,c.value.style.zIndex="9999",c.value.style.opacity="0.8",c.value.style.transform="rotate(2deg)",c.value.style.pointerEvents="none",c.value.classList.add("dragging"),document.body.appendChild(c.value),m.classList.add("dragging"),"vibrate"in navigator&&navigator.vibrate(50)}catch(o){console.warn("Touch start error:",o),T()}}function ee(t){if(!D.value)return;t.preventDefault();const o=t.touches[0];J(o.clientY),y.value={x:o.clientX,y:o.clientY};const m=50,k=50;c.value&&(c.value.style.left=`${o.clientX-m}px`,c.value.style.top=`${o.clientY-k}px`);const I=document.elementFromPoint(o.clientX,o.clientY),E=I==null?void 0:I.closest("[data-drop-zone]");if(v.value=!1,x.value.fill(!1),E){const p=parseInt(E.getAttribute("data-drop-zone")||"0");p===0?v.value=!0:p<=x.value.length&&(x.value[p]=!0)}}function te(t){if(r(),!!D.value)try{t.preventDefault(),D.value=!1;const o=t.changedTouches[0];if(!o){T();return}const m=document.elementFromPoint(o.clientX,o.clientY),k=m==null?void 0:m.closest("[data-drop-zone]");c.value&&(c.value.style.transition="opacity 0.2s ease-out",c.value.style.opacity="0",setTimeout(()=>{c.value&&document.body.contains(c.value)&&document.body.removeChild(c.value),c.value=null},200));const I=document.querySelector(".dragging");if(I&&I.classList.remove("dragging"),v.value=!1,x.value.fill(!1),k&&a.currentTrack){const E=parseInt(k.getAttribute("data-drop-zone")||"0");"vibrate"in navigator&&navigator.vibrate(100),B("placeTrack",a.currentTrack,E)}}catch(o){console.warn("Touch end error:",o),T()}}function oe(t){D.value&&(J(t.clientY),y.value={x:t.clientX,y:t.clientY})}function W(){r(),c.value&&(c.value.style.transition="opacity 0.2s ease-out",c.value.style.opacity="0",setTimeout(()=>{c.value&&document.body.contains(c.value)&&document.body.removeChild(c.value),c.value=null},200));const t=document.querySelector(".dragging");t&&t.classList.remove("dragging"),v.value=!1,x.value.fill(!1)}function J(t){z||(z=setInterval(()=>{const o=window.innerHeight,m=100,k=5;t<m?window.scrollBy(0,-k):t>o-m&&window.scrollBy(0,k)},16))}function r(){z&&(clearInterval(z),z=null)}function g(){var o;const t=((o=a.player)==null?void 0:o.timeline)||[];x.value=new Array(t.length+1).fill(!1)}function T(){D.value=!1,v.value=!1,x.value.fill(!1),c.value&&document.body.contains(c.value)&&(document.body.removeChild(c.value),c.value=null),document.querySelectorAll(".dragging").forEach(o=>o.classList.remove("dragging"))}return K(()=>{r(),T()}),ne(()=>{var t;return(((t=a.player)==null?void 0:t.timeline)||[]).length},()=>{g()},{immediate:!0}),(t,o)=>{var m,k,I,E;return n(),i("div",{class:R(["card relative overflow-hidden",{"ring-2 ring-cyan-400 shadow-2xl shadow-cyan-400/20":t.isCurrent}])},[t.isCurrent?(n(),i("div",ut,o[17]||(o[17]=[e("div",{class:"absolute top-0 left-0 w-64 h-64 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full blur-3xl animate-pulse"},null,-1),e("div",{class:"absolute bottom-0 right-0 w-80 h-80 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full blur-3xl animate-pulse delay-1000"},null,-1)]))):b("",!0),e("div",dt,[e("div",ct,[e("h3",gt,[e("span",{class:R(t.isCurrent?"bg-gradient-to-r from-cyan-300 to-blue-300 bg-clip-text text-transparent":"text-gray-200")},s(t.player.name),3),t.isCurrent?(n(),i("span",mt,"👑")):b("",!0)]),e("div",vt,[e("p",pt,s(t.player.score),1),e("div",ft,[o[18]||(o[18]=e("span",{class:"text-lg"},"🎵",-1)),e("span",ht,s(t.$t("game.score.tokens",{count:t.player.tokens})),1)])])]),t.isCurrent&&t.canPlace&&t.player.tokens>0?(n(),i("div",bt,[e("h4",yt,s(t.$t("game.tokenAbilities")),1),e("div",kt,[e("button",{onClick:o[0]||(o[0]=p=>M("skip")),class:"group relative px-4 py-2 bg-gradient-to-r from-orange-600 to-pink-600 hover:from-orange-500 hover:to-pink-500 text-white rounded-xl font-medium transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-orange-500/25",title:t.$t("game.tokens.skip.description")},[e("div",wt,[o[19]||(o[19]=e("span",{class:"text-lg"},"⏭️",-1)),e("span",null,s(t.$t("game.tokens.skip.label")),1)])],8,xt),e("button",{onClick:o[1]||(o[1]=p=>M("hint")),class:"group relative px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-xl font-medium transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-cyan-500/25",title:t.$t("game.tokens.hint.description")},[e("div",_t,[o[20]||(o[20]=e("span",{class:"text-lg"},"💡",-1)),e("span",null,s(t.$t("game.tokens.hint.label")),1)])],8,$t)])])):b("",!0),e("div",Tt,[e("h4",Pt,[o[21]||(o[21]=e("span",{class:"mr-2"},"🎵",-1)),de(" "+s(t.$t("game.timeline.title")),1)]),!t.player.timeline||t.player.timeline.length===0?(n(),i("div",Ct,[o[22]||(o[22]=e("div",{class:"mb-4"},[e("div",{class:"w-20 h-20 mx-auto bg-gradient-to-br from-gray-700 to-gray-800 rounded-full flex items-center justify-center shadow-lg"},[e("span",{class:"text-3xl"},"🎼")])],-1)),e("p",St,s(t.$t("game.timeline.empty")),1),t.canPlace?(n(),i("div",{key:0,class:R(["timeline-slot mt-6 group",{"drag-over":v.value,selected:_.value===0&&f.value}]),onDragover:o[2]||(o[2]=j(p=>v.value=!0,["prevent"])),onDragleave:o[3]||(o[3]=j(p=>v.value=!1,["prevent"])),onDrop:o[4]||(o[4]=j(p=>u(0),["prevent"])),onTouchstart:o[5]||(o[5]=j(p=>f.value?$(0):null,["prevent"])),onClick:o[6]||(o[6]=p=>f.value?$(0):null),"data-drop-zone":0},[e("div",{class:R(["p-8 border-2 border-dashed border-gray-500 rounded-2xl group-hover:border-purple-400 transition-colors duration-300 bg-gradient-to-br from-gray-800/30 to-gray-900/30 backdrop-blur-sm",{"border-green-400 bg-green-500/20":_.value===0&&f.value}])},[e("p",zt,s(f.value?t.$t("game.timeline.tapToSelect"):t.$t("game.timeline.placeHere")),1)],2)],34)):b("",!0)])):t.player.timeline&&t.player.timeline.length>0?(n(),i("div",Mt,[t.canPlace?(n(),i("div",{key:0,class:R(["timeline-slot h-20 group",{"drag-over":x.value[0],selected:_.value===0&&f.value}]),onDragover:o[7]||(o[7]=j(p=>x.value[0]=!0,["prevent"])),onDragleave:o[8]||(o[8]=j(p=>x.value[0]=!1,["prevent"])),onDrop:o[9]||(o[9]=j(p=>u(0),["prevent"])),onTouchstart:o[10]||(o[10]=j(p=>f.value?$(0):null,["prevent"])),onClick:o[11]||(o[11]=p=>f.value?$(0):null),"data-drop-zone":0},[e("div",{class:R(["h-full border-2 border-dashed border-gray-600 rounded-xl group-hover:border-cyan-400 transition-colors duration-300 bg-gradient-to-r from-gray-800/20 to-gray-700/20 backdrop-blur-sm flex items-center justify-center",{"border-green-400 bg-green-500/20":_.value===0&&f.value}])},[e("p",jt,s(f.value?t.$t("game.timeline.tapToSelect"):t.$t("game.placeEarlier")),1)],2)],34)):b("",!0),(n(!0),i(re,null,ae(t.player.timeline||[],(p,d)=>{var Y;return n(),i("div",{key:p.id,class:"track-card group relative"},[e("div",At,[e("div",Dt,[e("div",Bt,[p.revealed?(n(),i("img",{key:0,src:G(p),alt:p.name,class:"w-16 h-16 object-cover"},null,8,It)):(n(),i("div",Rt,o[23]||(o[23]=[e("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})],-1)])))]),e("div",Lt,[e("p",Et,s(p.name),1),e("p",Nt,s(V(p)),1)]),e("div",Ft,[e("p",Ot,s(p.year),1)])])]),t.canPlace&&d<(((Y=t.player.timeline)==null?void 0:Y.length)||0)-1?(n(),i("div",{key:0,class:R(["timeline-slot h-20 mt-3 group",{"drag-over":x.value[d+1],selected:_.value===d+1&&f.value}]),onDragover:j(H=>x.value[d+1]=!0,["prevent"]),onDragleave:j(H=>x.value[d+1]=!1,["prevent"]),onDrop:j(H=>u(d+1),["prevent"]),onTouchstart:j(H=>f.value?$(d+1):null,["prevent"]),onClick:H=>f.value?$(d+1):null,"data-drop-zone":d+1},[e("div",{class:R(["h-full border-2 border-dashed border-gray-600 rounded-xl group-hover:border-purple-400 transition-colors duration-300 bg-gradient-to-r from-gray-800/20 to-gray-700/20 backdrop-blur-sm flex items-center justify-center",{"border-green-400 bg-green-500/20":_.value===d+1&&f.value}])},[e("p",Ut,s(f.value?t.$t("game.timeline.tapToSelect"):t.$t("game.placeBetween")),1)],2)],42,Vt)):b("",!0)])}),128)),t.canPlace?(n(),i("div",{key:1,class:R(["timeline-slot h-20 group",{"drag-over":x.value[((m=t.player.timeline)==null?void 0:m.length)||0],selected:_.value===(((k=t.player.timeline)==null?void 0:k.length)||0)&&f.value}]),onDragover:o[12]||(o[12]=j(p=>{var d;return x.value[((d=t.player.timeline)==null?void 0:d.length)||0]=!0},["prevent"])),onDragleave:o[13]||(o[13]=j(p=>{var d;return x.value[((d=t.player.timeline)==null?void 0:d.length)||0]=!1},["prevent"])),onDrop:o[14]||(o[14]=j(p=>{var d;return u(((d=t.player.timeline)==null?void 0:d.length)||0)},["prevent"])),onTouchstart:o[15]||(o[15]=j(p=>{var d;return f.value?$(((d=t.player.timeline)==null?void 0:d.length)||0):null},["prevent"])),onClick:o[16]||(o[16]=p=>{var d;return f.value?$(((d=t.player.timeline)==null?void 0:d.length)||0):null}),"data-drop-zone":((I=t.player.timeline)==null?void 0:I.length)||0},[e("div",{class:R(["h-full border-2 border-dashed border-gray-600 rounded-xl group-hover:border-cyan-400 transition-colors duration-300 bg-gradient-to-r from-gray-800/20 to-gray-700/20 backdrop-blur-sm flex items-center justify-center",{"border-green-400 bg-green-500/20":_.value===(((E=t.player.timeline)==null?void 0:E.length)||0)&&f.value}])},[e("p",Xt,s(f.value?t.$t("game.timeline.tapToSelect"):t.$t("game.placeLater")),1)],2)],42,Yt)):b("",!0)])):b("",!0)]),t.canPlace&&t.currentTrack?(n(),i("div",{key:1,ref_key:"scrollContainer",ref:w,class:"timeline-container p-6 bg-gradient-to-r from-blue-900/50 to-purple-900/50 border-2 border-blue-400/30 rounded-2xl cursor-move touch-manipulation select-none backdrop-blur-sm shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-[1.02]",draggable:"true",onDragstart:Z,onDragend:l,onTouchstart:Q,onTouchmove:ee,onTouchend:te,onMousemove:oe,onMouseup:W,style:{touchAction:"none"}},[e("div",qt,[o[24]||(o[24]=e("div",{class:"w-16 h-16 rounded-xl bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center flex-shrink-0 shadow-lg"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})])],-1)),e("div",Ht,[e("p",Gt,s(t.$t("game.newTrack")),1),e("p",Wt,s(t.$t("game.dragToPlace")),1)]),o[25]||(o[25]=e("div",{class:"text-blue-300"},[e("span",{class:"text-3xl animate-pulse"},"🎵")],-1))])],544)):b("",!0),t.player.timeline&&t.player.timeline.length>0?(n(),i("div",Zt,[e("div",Jt,[e("span",Kt,s(t.$t("game.tracksInTimeline",{count:t.player.timeline.length})),1),O.value?(n(),i("span",Qt,s(O.value),1)):b("",!0)])])):b("",!0)]),A.value&&f.value?(n(),i("div",eo,[e("div",to,[o[27]||(o[27]=e("div",{class:"absolute inset-0 opacity-10"},[e("div",{class:"absolute top-0 left-0 w-24 h-24 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full blur-3xl animate-pulse"}),e("div",{class:"absolute bottom-0 right-0 w-32 h-32 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full blur-3xl animate-pulse delay-1000"})],-1)),e("div",oo,[e("div",so,[o[26]||(o[26]=e("div",{class:"w-10 h-10 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg"},[e("span",{class:"text-xl"},"📍")],-1)),e("h3",ro,s(t.$t("game.timeline.selectedPosition")),1)]),e("div",ao,[e("p",lo,s(C(_.value)),1)]),e("div",no,[e("button",{onClick:U,class:"flex-1 px-4 py-3 bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-500 hover:to-gray-600 text-white font-medium rounded-xl transition-all duration-300 hover:scale-105 shadow-lg"},s(t.$t("game.timeline.cancelSelection")),1),e("button",{onClick:N,class:"flex-1 px-4 py-3 bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-500 hover:to-blue-500 text-white font-bold rounded-xl transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-green-500/25"},s(t.$t("game.timeline.confirmPlacement")),1)])])])])):b("",!0)],2)}}}),uo={class:"min-h-screen flex flex-col"},co={class:"bg-white/10 backdrop-blur-sm p-4"},go={class:"flex justify-between items-center"},mo={class:"flex items-center space-x-4"},vo={class:"text-white"},po={class:"text-xl font-bold"},fo={class:"flex items-center space-x-3 text-sm opacity-80"},ho={key:0,class:"px-2 py-1 bg-purple-500/30 rounded-full border border-purple-400/50 text-purple-200 font-medium"},bo={key:1,class:"px-2 py-1 bg-gray-500/30 rounded-full border border-gray-400/50 text-gray-200 font-medium"},yo={class:"text-white text-right"},ko={class:"text-sm opacity-80"},xo={class:"flex-1 container mx-auto px-4 py-6"},wo={key:0,class:"max-w-2xl mx-auto"},$o={class:"card text-center"},_o={class:"text-2xl font-semibold mb-4"},To={class:"text-gray-600 mb-6"},Po={key:1,class:"space-y-6"},Co={class:"card text-center bg-green-50 border-green-200"},So={class:"text-2xl font-bold text-white mb-2"},zo={class:"text-white"},Mo={key:0,class:"mt-4"},jo={key:1,class:"mt-4"},Ao={class:"flex items-center justify-center space-x-2"},Do={key:0,class:"card bg-yellow-50 border-yellow-200"},Bo={class:"flex items-center space-x-3"},Io={class:"flex-1"},Ro={class:"text-lg font-semibold text-yellow-800"},Lo={class:"text-yellow-700 text-sm"},Eo={class:"flex space-x-2"},No={key:1,class:"card bg-orange-50 border-orange-200"},Fo={key:3,class:"text-center mb-6"},Oo={class:"card bg-gradient-to-r from-red-900/40 to-pink-900/40 border border-red-400/30 backdrop-blur-sm"},Vo={class:"mb-4"},Uo={class:"flex items-center justify-center mb-3"},Yo={class:"text-center"},Xo={class:"text-2xl font-bold text-red-200 mb-2"},qo={class:"text-red-100"},Ho={class:"text-lg font-semibold"},Go={class:"text-base"},Wo={class:"text-sm opacity-90"},Zo={class:"text-red-200 text-lg mb-4"},Jo={class:"text-red-300 text-sm"},Ko={key:4,class:"max-w-4xl mx-auto"},Qo={class:"card"},es={class:"text-lg font-semibold mb-4 text-gray-100"},ts={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},os={class:"font-semibold text-gray-800"},ss={class:"text-2xl font-bold text-gray-900"},rs={class:"text-sm text-gray-600"},as={class:"text-xs text-gray-500"},ls={key:2,class:"max-w-2xl mx-auto"},ns={class:"card text-center"},is={class:"text-3xl font-bold mb-4 text-white"},us={class:"text-xl mb-6"},ds={class:"mb-6"},cs={class:"text-lg font-semibold mb-3"},gs={class:"space-y-2"},ms={class:"font-medium"},vs={class:"font-bold"},ps={class:"flex space-x-4 justify-center"},fs={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},hs={class:"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 border border-purple-500/20 shadow-2xl shadow-purple-500/10 rounded-2xl p-8 max-w-md w-full mx-auto relative overflow-hidden"},bs={class:"relative z-10"},ys={class:"flex items-center space-x-3 mb-6"},ks={class:"text-2xl font-bold bg-gradient-to-r from-cyan-300 to-blue-300 bg-clip-text text-transparent"},xs={class:"mb-8"},ws={class:"text-gray-200 text-lg leading-relaxed"},$s={class:"flex justify-center"},Ts=le({__name:"GameView",setup(X){const F=me(),a=ge(),B=h(!1),v=h(!1),x=h(""),_=h(S.isAuthenticated()),A=h(!1),D=h(!1),q=h(!1),L=h({isCorrect:!1,pointsEarned:0}),c=P(()=>a.players),y=P(()=>a.currentPlayer),w=P(()=>a.currentTrack),z=P(()=>a.gamePhase),f=P(()=>a.round),O=P(()=>a.settings),G=P(()=>a.winner),V=P(()=>_.value),Z=P(()=>V.value?!S.isPlayerReady()&&u.value>3e4:!1),l=h(Date.now()),u=P(()=>Date.now()-l.value),M=P(()=>[...c.value].sort((r,g)=>{var o,m;const T=((o=r.timeline)==null?void 0:o.length)||0,t=((m=g.timeline)==null?void 0:m.length)||0;return t!==T?t-T:g.tokens!==r.tokens?g.tokens-r.tokens:g.score-r.score}));async function $(){var r;B.value=!0,A.value=!1,D.value=!1,L.value={isCorrect:!1,pointsEarned:0};try{console.log("Loading next track...");const g=await a.getNextTrack();g?console.log("Track loaded successfully:",g.name,"by",(r=g.artists[0])==null?void 0:r.name):console.error("No tracks available")}catch(g){console.error("Error loading track:",g)}finally{B.value=!1}}function C(r,g){const T=a.placeTrackOnTimeline(r,g);let t=0;T&&y.value&&(t=1,y.value.timeline.length>=5&&(t=2),y.value.timeline.length>=8&&(t=3)),L.value={isCorrect:T,pointsEarned:t},A.value=!0,setTimeout(()=>{D.value=!0},500),T?setTimeout(()=>{A.value=!1,D.value=!1,a.nextPlayer()},4e3):setTimeout(()=>{if(q.value=!0,y.value&&w.value){const o=N(w.value,y.value.timeline),m={...w.value,revealed:!0};a.addTrackToTimelineAtPosition(m,o)}},1500)}function N(r,g){for(let T=0;T<g.length;T++)if(r.year<=g[T].year)return T;return g.length}function U(){w.value&&y.value&&a.removeTrackFromTimeline(w.value.id),A.value=!1,D.value=!1,q.value=!1,a.nextPlayer()}function Q(r){var T;if(!y.value)return;if(a.useToken(y.value.id,r))switch(r){case"skip":$();break;case"hint":const t=Math.floor(((T=w.value)==null?void 0:T.year)/10)*10;x.value=`This track was released in the ${t}s`,v.value=!0;break}}function ee(){v.value=!1,x.value=""}function te(){a.resetGame(),F.push("/")}function oe(){F.push("/")}function W(){const r=S.isAuthenticated();console.log("Spotify auth check in GameView:",{isAuthenticated:r,previousState:V.value}),_.value!==r&&(_.value=r,console.log("Spotify auth state updated:",r)),r&&!S.isPlayerReady()&&(console.log("Initializing player after auth check"),S.initializePlayerIfReady())}async function J(){console.log("🔄 Re-authorizing Spotify with updated permissions"),await S.forceReauth(),W()}return se(()=>{a.gamePhase==="setup"&&a.players.length===0&&F.push("/"),W();const r=setInterval(()=>{_.value||W()},12e4);K(()=>{clearInterval(r)})}),ne(w,r=>{r&&(A.value=!1,D.value=!1,L.value={isCorrect:!1,pointsEarned:0})}),(r,g)=>{var T,t,o,m,k,I,E,p;return n(),i("div",uo,[e("header",co,[e("div",go,[e("div",mo,[e("button",{onClick:g[0]||(g[0]=d=>r.$router.push("/")),class:"btn btn-secondary"}," ← "+s(r.$t("common.back")),1),e("div",vo,[e("h1",po,s(r.$t("game.title")),1),e("div",fo,[e("span",null,s(r.$t("game.round"))+" "+s(f.value),1),O.value.theme?(n(),i("span",ho," 🎵 "+s(r.$t(`game.themes.${O.value.theme}`)),1)):(n(),i("span",bo," 🎵 "+s(r.$t("game.allMusic")),1))])])]),e("div",yo,[e("p",ko,s(r.$t("game.turn.currentPlayer",{player:(T=y.value)==null?void 0:T.name})),1)])])]),e("main",xo,[z.value==="setup"?(n(),i("div",wo,[e("div",$o,[e("h2",_o,s(r.$t("game.setupRequired")),1),e("p",To,s(r.$t("game.setupMessage")),1),e("button",{onClick:g[1]||(g[1]=d=>r.$router.push("/")),class:"btn btn-primary"},s(r.$t("game.backToSetup")),1)])])):z.value==="playing"?(n(),i("div",Po,[e("div",Co,[e("h2",So,s(r.$t("game.turn.currentPlayer",{player:(t=y.value)==null?void 0:t.name})),1),e("p",zo,s(r.$t("game.turn.ready")),1),!w.value&&!B.value?(n(),i("div",Mo,[e("button",{onClick:$,class:"btn btn-primary btn-lg"}," 🎵 "+s(r.$t("game.getTrack")),1)])):b("",!0),B.value?(n(),i("div",jo,[e("div",Ao,[g[3]||(g[3]=e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-green-500"},null,-1)),e("span",null,s(r.$t("common.loading")),1)])])):b("",!0)]),V.value?V.value&&Z.value?(n(),i("div",No,[e("div",{class:"flex items-center space-x-3"},[g[5]||(g[5]=ue('<div class="flex-shrink-0"><svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"></path></svg></div><div class="flex-1"><h3 class="text-lg font-semibold text-orange-800">Playback Permissions Needed</h3><p class="text-orange-700 text-sm">Your Spotify connection needs updated permissions to play music.</p></div>',2)),e("div",{class:"flex space-x-2"},[e("button",{onClick:J,class:"btn btn-sm bg-orange-600 hover:bg-orange-700 text-white"}," 🔐 Update Permissions ")])])])):b("",!0):(n(),i("div",Do,[e("div",Bo,[g[4]||(g[4]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 18.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("div",Io,[e("h3",Ro,s(r.$t("game.spotify.notConnected")),1),e("p",Lo,s(r.$t("game.demoModeActive")),1)]),e("div",Eo,[e("button",{onClick:oe,class:"btn btn-sm bg-yellow-600 hover:bg-yellow-700 text-white"},s(r.$t("game.spotify.login")),1),e("button",{onClick:J,class:"btn btn-sm bg-purple-600 hover:bg-purple-700 text-white"}," 🔐 Re-auth "),e("button",{onClick:W,class:"btn btn-sm bg-blue-600 hover:bg-blue-700 text-white"}," 🔄 Refresh ")])])])),w.value?(n(),ve(it,{key:2,track:w.value,"show-result":A.value,"show-answer":D.value,"is-correct":L.value.isCorrect,"points-earned":L.value.pointsEarned,onPlaceTrack:C},null,8,["track","show-result","show-answer","is-correct","points-earned"])):b("",!0),q.value&&!L.value.isCorrect?(n(),i("div",Fo,[e("div",Oo,[e("div",Vo,[e("div",Uo,[g[6]||(g[6]=e("div",{class:"w-12 h-12 bg-gradient-to-br from-red-500 to-pink-500 rounded-full flex items-center justify-center mr-3"},[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 18.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("div",Yo,[e("h3",Xo,s(r.$t("game.turn.wrongPlacement")),1),e("div",qo,[e("p",Ho,s((o=w.value)==null?void 0:o.name),1),e("p",Go,s((m=w.value)==null?void 0:m.artists.map(d=>d.name).join(", ")),1),e("p",Wo,s(r.$t("game.turn.releasedIn",{year:(k=w.value)==null?void 0:k.year})),1)])])]),e("p",Zo,s(r.$t("game.turn.correctPlacement")),1),e("p",Jo,s(r.$t("game.turn.studyTimeline")),1)]),e("button",{onClick:U,class:"px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white font-bold rounded-xl transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-blue-500/25"},s(r.$t("game.turn.continue")),1)])])):b("",!0),y.value&&y.value.timeline?(n(),i("div",Ko,[pe(io,{player:y.value,"is-current":!0,"current-track":w.value,"can-place":!!w.value,onPlaceTrack:C,onUseToken:Q},null,8,["player","current-track","can-place"])])):b("",!0),e("div",Qo,[e("h3",es,s(r.$t("game.score.title")),1),e("div",ts,[(n(!0),i(re,null,ae(c.value,d=>{var Y;return n(),i("div",{key:d.id,class:R(["text-center p-3 rounded-lg",d.id===((Y=y.value)==null?void 0:Y.id)?"bg-green-100 border-2 border-green-300":"bg-gray-50"])},[e("p",os,s(d.name),1),e("p",ss,s(d.tokens),1),e("p",rs,s(r.$t("game.score.tokens",{count:d.tokens})),1),e("p",as,s(r.$t("game.score.total",{score:d.score})),1)],2)}),128))])])])):z.value==="finished"?(n(),i("div",ls,[e("div",ns,[e("h2",is,s(r.$t("game.end.title")),1),e("p",us,s(r.$t("game.end.winner",{player:(I=G.value)==null?void 0:I.name,score:((p=(E=G.value)==null?void 0:E.timeline)==null?void 0:p.length)||0})),1),e("div",ds,[e("h3",cs,s(r.$t("game.end.finalScores")),1),e("div",gs,[(n(!0),i(re,null,ae(M.value,(d,Y)=>{var H;return n(),i("div",{key:d.id,class:R(["flex justify-between items-center p-3 rounded-lg",Y===0?"bg-yellow-100":"bg-gray-50"])},[e("span",ms,s(Y+1)+". "+s(d.name),1),e("span",vs,s(((H=d.timeline)==null?void 0:H.length)||0)+" "+s(r.$t("game.songs"))+" | "+s(d.tokens)+" "+s(r.$t("game.score.tokens",{count:d.tokens})),1)],2)}),128))])]),e("div",ps,[e("button",{onClick:te,class:"btn btn-primary"}," 🔄 "+s(r.$t("game.end.playAgain")),1),e("button",{onClick:g[2]||(g[2]=d=>r.$router.push("/")),class:"btn btn-secondary"}," 🏠 "+s(r.$t("game.backToHome")),1)])])])):b("",!0)]),v.value?(n(),i("div",fs,[e("div",hs,[g[8]||(g[8]=e("div",{class:"absolute inset-0 opacity-10"},[e("div",{class:"absolute top-0 left-0 w-32 h-32 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full blur-3xl animate-pulse"}),e("div",{class:"absolute bottom-0 right-0 w-40 h-40 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full blur-3xl animate-pulse delay-1000"})],-1)),e("div",bs,[e("div",ys,[g[7]||(g[7]=e("div",{class:"w-12 h-12 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg"},[e("span",{class:"text-2xl"},"💡")],-1)),e("h3",ks,s(r.$t("game.tokens.hint.label")),1)]),e("div",xs,[e("p",ws,s(x.value),1)]),e("div",$s,[e("button",{onClick:ee,class:"px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white font-bold rounded-xl transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-purple-500/25"},s(r.$t("common.close")),1)])])])])):b("",!0)])}}});export{Ts as default};
