import{d as G,u as M,r as c,c as v,o as j,s as u,a as P,w as _,b as d,e,t as s,f as h,g as L,h as U,i as f,v as $,F as z,j as T,k as E,l as m,m as q}from"./index-8XM8goK0.js";const B={class:"min-h-screen bg-gradient-to-br from-slate-950 via-purple-950 to-slate-900 text-white p-8"},D={class:"p-4 flex justify-between items-center"},F={class:"flex items-center space-x-2"},J={class:"text-3xl font-bold text-white"},O={class:"text-white/80 text-sm"},H={class:"flex-1 container mx-auto px-4 py-8"},K={class:"max-w-2xl mx-auto"},Q={key:0,class:"card mb-6 bounce-in"},W={class:"text-2xl font-bold mb-4 text-white"},X={class:"flex justify-between items-center"},Y={class:"text-slate-300 font-medium"},Z={class:"text-slate-300 font-medium"},ee={class:"card"},te={class:"text-3xl font-bold mb-8 text-white bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent"},se={key:0,class:"mb-8 p-6 bg-gradient-to-r from-green-900/40 to-emerald-900/40 border border-green-500/30 rounded-2xl backdrop-blur-sm"},ae={class:"flex items-center space-x-4 mb-4"},oe={class:"font-bold text-xl text-white"},le={class:"text-white font-medium"},ne=["disabled"],ie={key:0,class:"flex items-center justify-center"},re={key:1,class:"flex items-center justify-center"},ue={key:0,class:"mt-4 p-3 bg-gray-800 rounded-lg text-sm"},de={class:"text-gray-300"},me={class:"block text-sm font-bold text-slate-200 mb-3"},ce={class:"block text-sm font-bold text-slate-200 mb-3"},pe={class:"space-y-3"},ge=["onUpdate:modelValue","placeholder"],ve={class:"block text-sm font-bold text-slate-200 mb-3"},he={value:"5"},fe={value:"6"},be={value:"7"},ye={value:"8"},_e={value:"9"},$e={value:"10"},we={class:"block text-sm font-bold text-slate-200 mb-3"},xe={value:""},ke={value:"guilty-pleasures"},Se={value:"belgian"},Ae={value:"classics"},Ie={value:"popular"},Ne={value:"vlaams"},Ce={value:"pop-rock"},Re=["disabled"],Me=G({__name:"HomeView",setup(Ve){const w=E(),p=M(),i=c(2),r=c(["","","",""]),b=c(10),y=c(""),g=c(!1),n=c(!1),x=c("Auth state will be checked..."),S=v(()=>p.players.length>0&&p.gamePhase!=="setup"),A=v(()=>p.players.map(t=>t.name)),I=v(()=>p.round),k=v(()=>{var t;if(!n.value)return!1;for(let a=0;a<i.value;a++)if(!((t=r.value[a])!=null&&t.trim()))return!1;return!0});function N(){n.value=u.isAuthenticated()}async function C(){g.value=!0;try{await u.initiateLogin()}catch(t){console.error("Login failed:",t)}finally{g.value=!1}}function R(){if(!k.value)return;const t=r.value.slice(0,i.value).map(a=>a.trim());p.updateSettings({targetSongs:b.value,theme:y.value||void 0,maxRounds:20,targetScore:10}),p.initializePlayers(t),w.push("/game")}function V(){w.push("/game")}return j(()=>{n.value=u.isAuthenticated(),n.value&&u.initializePlayerIfReady();const t=localStorage.getItem("hitster-player-names");if(t)try{const o=JSON.parse(t);Array.isArray(o)&&(r.value=[...o,"","","",""].slice(0,4),i.value=Math.max(2,Math.min(4,o.length)))}catch(o){console.error("Error loading saved player names:",o)}const a=setInterval(()=>{const o=u.isAuthenticated();o!==n.value&&(n.value=o,o&&(u.initializePlayerIfReady(),clearInterval(a)))},500);setTimeout(()=>{clearInterval(a)},1e4);const l=()=>{const o=u.isAuthenticated();o!==n.value&&(n.value=o,o&&u.initializePlayerIfReady())};window.addEventListener("focus",l),P(()=>{window.removeEventListener("focus",l),clearInterval(a)})}),_(n,t=>{t&&u.initializePlayerIfReady()},{immediate:!0}),_(i,t=>{const a=[...r.value];for(;a.length<4;)a.push("");r.value=a},{immediate:!0}),_([r,i],()=>{const t=r.value.slice(0,i.value).filter(a=>a.trim());t.length>0&&localStorage.setItem("hitster-player-names",JSON.stringify(t))},{deep:!0}),(t,a)=>(m(),d("div",B,[e("header",D,[e("div",F,[e("h1",J,s(t.$t("game.title")),1),e("span",O,s(t.$t("game.subtitle")),1)]),e("button",{onClick:a[0]||(a[0]=l=>t.$router.push("/settings")),class:"btn btn-secondary"}," ⚙️ "+s(t.$t("settings.language")),1)]),e("main",H,[e("div",K,[S.value?(m(),d("div",Q,[e("h2",W,s(t.$t("game.continue")),1),e("div",X,[e("div",null,[e("p",Y,s(t.$t("game.players"))+": "+s(A.value.join(", ")),1),e("p",Z,s(t.$t("game.round"))+": "+s(I.value),1)]),e("button",{onClick:V,class:"btn btn-primary"},s(t.$t("common.continue")),1)])])):h("",!0),e("div",ee,[e("h2",te,s(t.$t("game.newGame")),1),n.value?h("",!0):(m(),d("div",se,[e("div",ae,[a[4]||(a[4]=e("div",{class:"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center"},[e("span",{class:"text-2xl"},"🎵")],-1)),e("div",null,[e("h3",oe,s(t.$t("game.spotify.required")),1),e("p",le,s(t.$t("game.spotify.loginRequired")),1)])]),e("button",{onClick:C,disabled:g.value,class:"btn bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white w-full font-bold text-lg py-4 shadow-lg hover:shadow-green-500/25"},[g.value?(m(),d("span",ie,[a[5]||(a[5]=e("div",{class:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent mr-2"},null,-1)),L(" "+s(t.$t("common.loading")),1)])):(m(),d("span",re," 🎵 "+s(t.$t("game.spotify.login")),1))],8,ne),x.value?(m(),d("div",ue,[e("p",de,"Debug: "+s(x.value),1),e("button",{onClick:N,class:"mt-2 text-xs bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded"}," Refresh Auth State ")])):h("",!0)])),n.value?(m(),d("form",{key:1,onSubmit:U(R,["prevent"]),class:"space-y-6"},[e("div",null,[e("label",me,s(t.$t("game.playerCount")),1),f(e("select",{"onUpdate:modelValue":a[1]||(a[1]=l=>i.value=l),class:"select"},a[6]||(a[6]=[e("option",{value:2},"2",-1),e("option",{value:3},"3",-1),e("option",{value:4},"4",-1)]),512),[[$,i.value,void 0,{number:!0}]])]),e("div",null,[e("label",ce,s(t.$t("game.playerNames")),1),e("div",pe,[(m(!0),d(z,null,T(i.value,l=>f((m(),d("input",{key:`player-${l}`,"onUpdate:modelValue":o=>r.value[l-1]=o,placeholder:t.$t("game.playerName",{number:l}),class:"input",required:"",maxlength:"20"},null,8,ge)),[[q,r.value[l-1]]])),128))])]),e("div",null,[e("label",ve,s(t.$t("game.targetSongs")),1),f(e("select",{"onUpdate:modelValue":a[2]||(a[2]=l=>b.value=l),class:"select"},[e("option",he,"5 "+s(t.$t("game.songs")),1),e("option",fe,"6 "+s(t.$t("game.songs")),1),e("option",be,"7 "+s(t.$t("game.songs")),1),e("option",ye,"8 "+s(t.$t("game.songs")),1),e("option",_e,"9 "+s(t.$t("game.songs")),1),e("option",$e,"10 "+s(t.$t("game.songs"))+" ("+s(t.$t("game.default"))+")",1)],512),[[$,b.value]])]),e("div",null,[e("label",we,s(t.$t("game.theme")),1),f(e("select",{"onUpdate:modelValue":a[3]||(a[3]=l=>y.value=l),class:"select"},[e("option",xe,s(t.$t("game.allMusic")),1),e("option",ke,s(t.$t("game.themes.guilty-pleasures")),1),e("option",Se,s(t.$t("game.themes.belgian")),1),e("option",Ae,s(t.$t("game.themes.classics")),1),e("option",Ie,s(t.$t("game.themes.popular")),1),e("option",Ne,s(t.$t("game.themes.vlaams")),1),e("option",Ce,s(t.$t("game.themes.pop-rock")),1)],512),[[$,y.value]])]),e("button",{type:"submit",disabled:!k.value,class:"btn btn-primary btn-lg w-full"}," 🎮 "+s(t.$t("common.start")),9,Re)],32)):h("",!0)])])])]))}});export{Me as default};
