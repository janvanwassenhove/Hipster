import{d as O,l as W,r as x,c as f,o as X,n as Y,w as K,m as Z,a as o,b as e,e as m,t,p as q,q as z,j as n,f as _,F,h as I,u as ee,s as te,i as se,x as J}from"./index-CUGT44jD.js";const le={class:"card"},ne={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6"},oe={class:"flex-shrink-0"},ae={key:0,class:"w-32 h-32 rounded-lg shadow-lg bg-gray-200 flex items-center justify-center"},re=["src","alt"],ie={class:"flex-1 text-center md:text-left"},de={key:0,class:"mb-4"},ce={class:"text-gray-600"},ue={class:"text-sm text-gray-500"},ve={key:1,class:"mb-4"},me={class:"text-xl font-bold text-gray-800"},ge={class:"text-lg text-gray-600"},pe={class:"text-sm text-gray-500"},fe={key:2,class:"mb-4"},he={class:"text-xl font-bold text-gray-800"},ye={class:"text-lg text-gray-600"},ke={class:"text-gray-600"},be={class:"text-sm text-gray-500"},$e={class:"mb-4"},_e={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center"},xe={class:"flex items-center justify-center mb-2"},we={class:"text-lg font-semibold text-blue-800"},Te={class:"text-blue-700 mb-2"},Me={class:"text-sm text-blue-600"},Ce={class:"text-xs text-blue-500 mt-1"},Pe=["src"],ze={key:2,class:"music-player-controls bg-gray-900 rounded-lg p-4"},Ae={class:"flex items-center justify-center space-x-6 mb-4"},Be=["disabled"],Le=["disabled"],De={key:0,class:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"},je={key:1,class:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20"},Se={key:2,class:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20"},Ve=["disabled"],Ee={key:0,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},He={key:1,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},Ne={key:2,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},Fe={class:"mb-3"},Ie={class:"flex items-center space-x-3 text-xs text-gray-300"},Re={class:"w-12 text-right"},Oe={class:"flex-1 relative"},Ue={class:"w-12"},Ge={class:"flex items-center space-x-3"},qe={class:"flex-1 relative"},Je=["value","disabled"],Xe={class:"text-xs text-gray-400 w-8"},Ke={key:3,class:"p-4 bg-blue-50 border border-blue-200 rounded-lg"},Qe={class:"text-center"},We={class:"text-lg font-bold text-blue-800"},Ye={class:"text-blue-700"},Ze={class:"text-blue-600"},et={class:"text-sm text-blue-500 mt-2"},tt=["href"],st={key:0,class:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg"},lt={class:"text-center font-medium text-yellow-800"},nt={class:"text-center text-sm text-yellow-700 mt-1"},ot={class:"font-bold text-lg"},at={key:0,class:"text-sm mt-1"},rt=O({__name:"TrackPlayer",props:{track:{},difficulty:{},showAnswer:{type:Boolean,default:!1},showResult:{type:Boolean,default:!1},isCorrect:{type:Boolean,default:!1},pointsEarned:{default:0}},emits:["placeTrack"],setup(S,{emit:L}){const d=S,{t:w}=W(),i=x(),u=x(!1),y=x(!1),M=x(!1),A=x(0),C=x(0),k=x(.7),h=x(!1),D=f(()=>{var b,R,N,G;const l=(R=(b=d.track.images)==null?void 0:b[0])==null?void 0:R.url,v=(G=(N=d.track.album.images)==null?void 0:N[0])==null?void 0:G.url;return l||v||"https://via.placeholder.com/300x300/6B7280/FFFFFF?text=No+Image"}),P=f(()=>d.track.artists.map(l=>l.name).join(", ")),s=f(()=>d.showResult?d.isCorrect?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800":""),r=f(()=>d.showResult?d.isCorrect?w("game.turn.correct",{year:d.track.year}):w("game.turn.incorrect",{year:d.track.year}):""),c=f(()=>C.value===0?0:A.value/C.value*100);function $(){i.value&&(console.log("Toggle playback called, isPlaying:",u.value,"canPlay:",M.value),u.value?i.value.pause():i.value.play().catch(l=>{console.error("Error playing audio:",l)}))}function a(){i.value&&(console.log("Restart track called"),i.value.currentTime=0,u.value&&i.value.play().catch(l=>{console.error("Error playing audio after restart:",l)}))}function p(){i.value&&(h.value?(i.value.volume=k.value,h.value=!1):(i.value.volume=0,h.value=!0))}function B(l){if(!i.value)return;const v=l.target,b=parseFloat(v.value);k.value=b,i.value.volume=b,b===0?h.value=!0:h.value&&(h.value=!1)}function V(l){if(!i.value||!d.track.preview_url)return;const b=l.currentTarget.getBoundingClientRect(),N=(l.clientX-b.left)/b.width*C.value;i.value.currentTime=N}function j(l){if(isNaN(l))return"0:00";const v=Math.floor(l/60),b=Math.floor(l%60);return`${v}:${b.toString().padStart(2,"0")}`}function E(){i.value&&(A.value=i.value.currentTime)}function g(){i.value&&(C.value=i.value.duration,i.value.volume=k.value)}function T(){y.value=!0,M.value=!1}function H(){y.value=!1,M.value=!0}function Q(){u.value=!1}X(()=>{Y(()=>{i.value&&U()})}),K(i,l=>{l&&U()});function U(){i.value&&(i.value.addEventListener("play",()=>{u.value=!0}),i.value.addEventListener("pause",()=>{u.value=!1}),i.value.volume=k.value)}return Z(()=>{i.value&&i.value.pause()}),(l,v)=>(n(),o("div",le,[e("div",ne,[e("div",oe,[l.showAnswer?(n(),o("img",{key:1,src:D.value,alt:l.track.name,class:"w-32 h-32 rounded-lg shadow-lg object-cover"},null,8,re)):(n(),o("div",ae,v[1]||(v[1]=[e("svg",{class:"w-16 h-16 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})],-1)])))]),e("div",ie,[l.difficulty==="original"?(n(),o("div",de,[e("p",ce,t(l.$t("game.turn.listening")),1),e("p",ue,t(l.$t("game.difficulties.originalHint")),1)])):l.difficulty==="pro"?(n(),o("div",ve,[e("h3",me,t(l.track.name),1),e("p",ge,t(P.value),1),e("p",pe,t(l.$t("game.difficulties.proHint")),1)])):l.difficulty==="expert"?(n(),o("div",fe,[e("h3",he,t(l.track.name),1),e("p",ye,t(P.value),1),e("p",ke,t(l.track.album.name),1),e("p",be,t(l.$t("game.difficulties.expertHint")),1)])):m("",!0),e("div",$e,[l.track.preview_url?m("",!0):(n(),o("div",_e,[e("div",xe,[v[2]||(v[2]=e("svg",{class:"w-8 h-8 text-blue-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})],-1)),e("h3",we,t(l.$t("game.demoMode")),1)]),e("p",Te,t(l.$t("game.noPreview")),1),e("p",Me,[e("strong",null,t(l.$t("game.needSpotifyForAudio")),1)]),e("p",Ce,t(l.$t("game.demoModeInstructions")),1)])),l.track.preview_url?(n(),o("audio",{key:1,ref_key:"audioPlayer",ref:i,src:l.track.preview_url,onEnded:Q,onTimeupdate:E,onLoadedmetadata:g,onLoadstart:T,onCanplay:H,preload:"metadata"},t(l.$t("game.audioNotSupported")),41,Pe)):m("",!0),l.track.preview_url?(n(),o("div",ze,[e("div",Ae,[e("button",{onClick:a,class:"control-btn",disabled:!l.track.preview_url,title:"Restart"},v[3]||(v[3]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z","clip-rule":"evenodd"})],-1)]),8,Be),e("button",{onClick:$,class:"play-btn",disabled:!l.track.preview_url},[y.value?(n(),o("div",De)):u.value?(n(),o("svg",je,v[4]||(v[4]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(n(),o("svg",Se,v[5]||(v[5]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"},null,-1)])))],8,Le),e("button",{onClick:p,class:"control-btn",disabled:!l.track.preview_url,title:"Mute/Unmute"},[h.value||k.value===0?(n(),o("svg",Ee,v[6]||(v[6]=[e("path",{"fill-rule":"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.83 13.6H2a1 1 0 01-1-1V7.4a1 1 0 011-1h2.83l3.553-3.193a1 1 0 011.617.793zM16 8.4A1 1 0 1117.6 7a4 4 0 010 6 1 1 0 11-1.6-1.2 2 2 0 000-3.6z","clip-rule":"evenodd"},null,-1),e("path",{d:"M18.293 6.293a1 1 0 011.414 1.414L17.414 10l2.293 2.293a1 1 0 01-1.414 1.414L16 11.414l-2.293 2.293a1 1 0 01-1.414-1.414L14.586 10l-2.293-2.293a1 1 0 011.414-1.414L16 8.586l2.293-2.293z"},null,-1)]))):k.value<.5?(n(),o("svg",He,v[7]||(v[7]=[e("path",{"fill-rule":"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.83 13.6H2a1 1 0 01-1-1V7.4a1 1 0 011-1h2.83l3.553-3.193a1 1 0 011.617.793zM15 8.4A1 1 0 1116.6 7a2 2 0 010 6 1 1 0 11-1.6-1.2V8.4z","clip-rule":"evenodd"},null,-1)]))):(n(),o("svg",Ne,v[8]||(v[8]=[e("path",{"fill-rule":"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.83 13.6H2a1 1 0 01-1-1V7.4a1 1 0 011-1h2.83l3.553-3.193a1 1 0 011.617.793zM15 8.4A1 1 0 1116.6 7a4 4 0 010 6 1 1 0 11-1.6-1.2 2 2 0 000-3.6z","clip-rule":"evenodd"},null,-1)])))],8,Ve)]),e("div",Fe,[e("div",Ie,[e("span",Re,t(j(A.value)),1),e("div",Oe,[e("div",{class:"progress-track",onClick:v[0]||(v[0]=b=>V(b))},[e("div",{class:"progress-fill",style:q({width:c.value+"%"})},null,4),e("div",{class:"progress-handle",style:q({left:c.value+"%"})},null,4)])]),e("span",Ue,t(j(C.value)),1)])]),e("div",Ge,[v[9]||(v[9]=e("svg",{class:"w-4 h-4 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.83 13.6H2a1 1 0 01-1-1V7.4a1 1 0 011-1h2.83l3.553-3.193a1 1 0 011.617.793z","clip-rule":"evenodd"})],-1)),e("div",qe,[e("input",{type:"range",min:"0",max:"1",step:"0.1",value:k.value,onInput:B,class:"volume-slider",disabled:!l.track.preview_url},null,40,Je)]),e("span",Xe,t(Math.round(k.value*100))+"%",1)])])):m("",!0)]),l.showAnswer?(n(),o("div",Ke,[e("div",Qe,[e("h4",We,t(l.track.name),1),e("p",Ye,t(P.value),1),e("p",Ze,t(l.track.album.name)+" ("+t(l.track.year)+")",1),e("p",et,[e("a",{href:l.track.external_urls.spotify,target:"_blank",rel:"noopener noreferrer",class:"underline hover:no-underline"},t(l.$t("game.openInSpotify"))+" ↗ ",9,tt)])])])):m("",!0)])]),l.showAnswer?m("",!0):(n(),o("div",st,[e("p",lt,t(l.$t("game.turn.placing")),1),e("p",nt,t(l.$t("game.dragToTimeline")),1)])),l.showResult?(n(),o("div",{key:1,class:z(["mt-4 p-4 rounded-lg text-center",s.value])},[e("p",ot,t(r.value),1),l.pointsEarned>0?(n(),o("p",at,t(l.$t("game.turn.points",{points:l.pointsEarned})),1)):m("",!0)],2)):m("",!0)]))}}),it={class:"flex items-center justify-between mb-4"},dt={class:"text-lg font-semibold flex items-center space-x-2"},ct={key:0,class:"text-green-500"},ut={class:"text-right"},vt={class:"text-2xl font-bold"},mt={class:"flex items-center space-x-2 text-sm text-gray-600"},gt={key:0,class:"mb-4"},pt={class:"text-sm font-medium text-gray-700 mb-2"},ft={class:"flex space-x-2"},ht=["title"],yt=["title"],kt={class:"mb-4"},bt={class:"text-sm font-medium text-gray-700 mb-2"},$t={key:0,class:"text-center py-8 text-gray-500"},_t={class:"text-center text-gray-500"},xt={key:1,class:"space-y-2"},wt={class:"text-center text-gray-500 text-sm"},Tt={class:"flex items-center space-x-3"},Mt={class:"w-12 h-12 rounded object-cover flex-shrink-0 relative"},Ct=["src","alt"],Pt={key:1,class:"w-12 h-12 rounded bg-gray-200 flex items-center justify-center"},zt={class:"flex-1 min-w-0"},At={class:"font-medium truncate"},Bt={class:"text-sm text-gray-600 truncate"},Lt={class:"text-right flex-shrink-0"},Dt={class:"font-bold text-lg"},jt=["onDragover","onDragleave","onDrop"],St={class:"text-center text-gray-500 text-sm"},Vt={class:"text-center text-gray-500 text-sm"},Et={class:"flex items-center space-x-3"},Ht={class:"flex-1 min-w-0"},Nt={class:"font-medium text-blue-800"},Ft={class:"text-sm text-blue-600"},It={key:2,class:"mt-4 pt-4 border-t border-gray-200"},Rt={class:"flex justify-between text-sm text-gray-600"},Ot={key:0},Ut=O({__name:"PlayerTimeline",props:{player:{},isCurrent:{type:Boolean},currentTrack:{},canPlace:{type:Boolean}},emits:["placeTrack","useToken"],setup(S,{emit:L}){const d=S,w=L,i=x(!1),u=x([]),y=f(()=>{if(d.player.timeline.length<2)return null;const s=d.player.timeline.map(r=>r.year).sort((r,c)=>r-c);return`${s[0]} - ${s[s.length-1]}`});function M(s){var r,c,$,a;return((c=(r=s.images)==null?void 0:r[0])==null?void 0:c.url)||((a=($=s.album.images)==null?void 0:$[0])==null?void 0:a.url)||"/placeholder-album.png"}function A(s){return s.artists.map(r=>r.name).join(", ")}function C(s){var c;if(!d.currentTrack)return;(c=s.dataTransfer)==null||c.setData("text/plain",JSON.stringify(d.currentTrack)),s.target.classList.add("dragging")}function k(s){s.target.classList.remove("dragging"),i.value=!1,u.value=[]}function h(s){!d.currentTrack||!d.canPlace||(i.value=!1,u.value=[],w("placeTrack",d.currentTrack,s))}function D(s){w("useToken",s)}function P(){u.value=new Array(d.player.timeline.length+1).fill(!1)}return K(()=>d.player.timeline.length,()=>{P()},{immediate:!0}),(s,r)=>(n(),o("div",{class:z(["card",{"ring-2 ring-green-500":s.isCurrent}])},[e("div",it,[e("h3",dt,[e("span",null,t(s.player.name),1),s.isCurrent?(n(),o("span",ct,"👑")):m("",!0)]),e("div",ut,[e("p",vt,t(s.player.score),1),e("div",mt,[r[11]||(r[11]=e("span",null,"🎵",-1)),e("span",null,t(s.$t("game.score.tokens",{count:s.player.tokens})),1)])])]),s.isCurrent&&s.canPlace&&s.player.tokens>0?(n(),o("div",gt,[e("h4",pt,t(s.$t("game.tokenAbilities")),1),e("div",ft,[e("button",{onClick:r[0]||(r[0]=c=>D("skip")),class:"btn btn-sm bg-yellow-100 hover:bg-yellow-200 text-yellow-800",title:s.$t("game.tokens.skip.description")}," ⏭️ "+t(s.$t("game.tokens.skip.label")),9,ht),e("button",{onClick:r[1]||(r[1]=c=>D("hint")),class:"btn btn-sm bg-blue-100 hover:bg-blue-200 text-blue-800",title:s.$t("game.tokens.hint.description")}," 💡 "+t(s.$t("game.tokens.hint.label")),9,yt)])])):m("",!0),e("div",kt,[e("h4",bt,t(s.$t("game.timeline.title")),1),s.player.timeline.length===0?(n(),o("div",$t,[e("p",null,t(s.$t("game.timeline.empty")),1),s.canPlace?(n(),o("div",{key:0,class:z(["timeline-slot mt-4",{"drag-over":i.value}]),onDragover:r[2]||(r[2]=_(c=>i.value=!0,["prevent"])),onDragleave:r[3]||(r[3]=_(c=>i.value=!1,["prevent"])),onDrop:r[4]||(r[4]=_(c=>h(0),["prevent"]))},[e("p",_t,t(s.$t("game.timeline.placeHere")),1)],34)):m("",!0)])):(n(),o("div",xt,[s.canPlace?(n(),o("div",{key:0,class:z(["timeline-slot h-16",{"drag-over":u.value[0]}]),onDragover:r[5]||(r[5]=_(c=>u.value[0]=!0,["prevent"])),onDragleave:r[6]||(r[6]=_(c=>u.value[0]=!1,["prevent"])),onDrop:r[7]||(r[7]=_(c=>h(0),["prevent"]))},[e("p",wt,t(s.$t("game.placeEarlier")),1)],34)):m("",!0),(n(!0),o(F,null,I(s.player.timeline,(c,$)=>(n(),o("div",{key:c.id,class:"track-card"},[e("div",Tt,[e("div",Mt,[c.revealed?(n(),o("img",{key:0,src:M(c),alt:c.name,class:"w-12 h-12 rounded object-cover"},null,8,Ct)):(n(),o("div",Pt,r[12]||(r[12]=[e("svg",{class:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})],-1)])))]),e("div",zt,[e("p",At,t(c.name),1),e("p",Bt,t(A(c)),1)]),e("div",Lt,[e("p",Dt,t(c.year),1)])]),s.canPlace&&$<s.player.timeline.length-1?(n(),o("div",{key:0,class:z(["timeline-slot h-16 mt-2",{"drag-over":u.value[$+1]}]),onDragover:_(a=>u.value[$+1]=!0,["prevent"]),onDragleave:_(a=>u.value[$+1]=!1,["prevent"]),onDrop:_(a=>h($+1),["prevent"])},[e("p",St,t(s.$t("game.placeBetween")),1)],42,jt)):m("",!0)]))),128)),s.canPlace?(n(),o("div",{key:1,class:z(["timeline-slot h-16",{"drag-over":u.value[s.player.timeline.length]}]),onDragover:r[8]||(r[8]=_(c=>u.value[s.player.timeline.length]=!0,["prevent"])),onDragleave:r[9]||(r[9]=_(c=>u.value[s.player.timeline.length]=!1,["prevent"])),onDrop:r[10]||(r[10]=_(c=>h(s.player.timeline.length),["prevent"]))},[e("p",Vt,t(s.$t("game.placeLater")),1)],34)):m("",!0)]))]),s.canPlace&&s.currentTrack?(n(),o("div",{key:1,class:"p-4 bg-blue-50 border-2 border-blue-200 rounded-lg cursor-move",draggable:"true",onDragstart:C,onDragend:k},[e("div",Et,[r[13]||(r[13]=e("div",{class:"w-12 h-12 rounded bg-blue-200 flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-6 h-6 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})])],-1)),e("div",Ht,[e("p",Nt,t(s.$t("game.newTrack")),1),e("p",Ft,t(s.$t("game.dragToPlace")),1)]),r[14]||(r[14]=e("div",{class:"text-blue-500"},[e("span",{class:"text-2xl"},"🎵")],-1))])],32)):m("",!0),s.player.timeline.length>0?(n(),o("div",It,[e("div",Rt,[e("span",null,t(s.$t("game.tracksInTimeline",{count:s.player.timeline.length})),1),y.value?(n(),o("span",Ot,t(y.value),1)):m("",!0)])])):m("",!0)],2))}}),Gt={class:"min-h-screen flex flex-col"},qt={class:"bg-white/10 backdrop-blur-sm p-4"},Jt={class:"flex justify-between items-center"},Xt={class:"flex items-center space-x-4"},Kt={class:"text-white"},Qt={class:"text-xl font-bold"},Wt={class:"text-sm opacity-80"},Yt={class:"text-white text-right"},Zt={class:"text-sm opacity-80"},es={class:"flex-1 container mx-auto px-4 py-6"},ts={key:0,class:"max-w-2xl mx-auto"},ss={class:"card text-center"},ls={class:"text-2xl font-semibold mb-4"},ns={class:"text-gray-600 mb-6"},os={key:1,class:"space-y-6"},as={class:"card text-center bg-green-50 border-green-200"},rs={class:"text-2xl font-bold text-green-800 mb-2"},is={class:"text-green-700"},ds={key:0,class:"mt-4"},cs={key:1,class:"mt-4"},us={class:"flex items-center justify-center space-x-2"},vs={key:0,class:"card bg-yellow-50 border-yellow-200"},ms={class:"flex items-center space-x-3"},gs={class:"flex-1"},ps={class:"text-lg font-semibold text-yellow-800"},fs={class:"text-yellow-700 text-sm"},hs={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ys={class:"card"},ks={class:"text-lg font-semibold mb-4"},bs={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},$s={class:"font-semibold"},_s={class:"text-2xl font-bold text-green-600"},xs={class:"text-sm text-gray-600"},ws={class:"text-xs text-gray-500"},Ts={key:2,class:"max-w-2xl mx-auto"},Ms={class:"card text-center"},Cs={class:"text-3xl font-bold mb-4 text-green-600"},Ps={class:"text-xl mb-6"},zs={class:"mb-6"},As={class:"text-lg font-semibold mb-3"},Bs={class:"space-y-2"},Ls={class:"font-medium"},Ds={class:"font-bold"},js={class:"flex space-x-4 justify-center"},Vs=O({__name:"GameView",setup(S){const L=se(),d=ee(),w=x(!1),i=f(()=>d.players),u=f(()=>d.currentPlayer),y=f(()=>d.currentTrack),M=f(()=>d.gamePhase),A=f(()=>d.round),C=f(()=>d.settings),k=f(()=>d.winner),h=f(()=>te.isAuthenticated()),D=f(()=>[...i.value].sort((a,p)=>p.tokens!==a.tokens?p.tokens-a.tokens:p.score-a.score));async function P(){w.value=!0;try{await d.getNextTrack()||console.error("No tracks available")}catch(a){console.error("Error loading track:",a)}finally{w.value=!1}}function s(a,p){d.placeTrackOnTimeline(a,p),setTimeout(()=>{d.nextPlayer()},2e3)}function r(a){var B;if(!u.value)return;if(d.useToken(u.value.id,a))switch(a){case"skip":P();break;case"hint":alert(`Hint: This track was released in the ${Math.floor(((B=y.value)==null?void 0:B.year)/10)*10}s`);break}}function c(){d.resetGame(),L.push("/")}function $(){L.push("/")}return X(()=>{d.gamePhase==="setup"&&d.players.length===0&&L.push("/")}),(a,p)=>{var B,V,j,E;return n(),o("div",Gt,[e("header",qt,[e("div",Jt,[e("div",Xt,[e("button",{onClick:p[0]||(p[0]=g=>a.$router.push("/")),class:"btn btn-secondary"}," ← "+t(a.$t("common.back")),1),e("div",Kt,[e("h1",Qt,t(a.$t("game.title")),1),e("p",Wt,t(a.$t("game.round"))+" "+t(A.value),1)])]),e("div",Yt,[e("p",Zt,t(a.$t("game.turn.currentPlayer",{player:(B=u.value)==null?void 0:B.name})),1)])])]),e("main",es,[M.value==="setup"?(n(),o("div",ts,[e("div",ss,[e("h2",ls,t(a.$t("game.setupRequired")),1),e("p",ns,t(a.$t("game.setupMessage")),1),e("button",{onClick:p[1]||(p[1]=g=>a.$router.push("/")),class:"btn btn-primary"},t(a.$t("game.backToSetup")),1)])])):M.value==="playing"?(n(),o("div",os,[e("div",as,[e("h2",rs,t(a.$t("game.turn.currentPlayer",{player:(V=u.value)==null?void 0:V.name})),1),e("p",is,t(a.$t("game.turn.ready")),1),!y.value&&!w.value?(n(),o("div",ds,[e("button",{onClick:P,class:"btn btn-primary btn-lg"}," 🎵 "+t(a.$t("game.getTrack")),1)])):m("",!0),w.value?(n(),o("div",cs,[e("div",us,[p[3]||(p[3]=e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-green-500"},null,-1)),e("span",null,t(a.$t("common.loading")),1)])])):m("",!0)]),h.value?m("",!0):(n(),o("div",vs,[e("div",ms,[p[4]||(p[4]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 18.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("div",gs,[e("h3",ps,t(a.$t("game.spotify.notConnected")),1),e("p",fs,t(a.$t("game.demoModeActive")),1)]),e("button",{onClick:$,class:"btn btn-sm bg-yellow-600 hover:bg-yellow-700 text-white"},t(a.$t("game.spotify.login")),1)])])),y.value?(n(),J(rt,{key:1,track:y.value,difficulty:C.value.difficulty,onPlaceTrack:s},null,8,["track","difficulty"])):m("",!0),e("div",hs,[(n(!0),o(F,null,I(i.value,g=>{var T,H;return n(),J(Ut,{key:g.id,player:g,"is-current":g.id===((T=u.value)==null?void 0:T.id),"current-track":y.value,"can-place":g.id===((H=u.value)==null?void 0:H.id)&&!!y.value,onPlaceTrack:s,onUseToken:r},null,8,["player","is-current","current-track","can-place"])}),128))]),e("div",ys,[e("h3",ks,t(a.$t("game.score.title")),1),e("div",bs,[(n(!0),o(F,null,I(i.value,g=>{var T;return n(),o("div",{key:g.id,class:z(["text-center p-3 rounded-lg",g.id===((T=u.value)==null?void 0:T.id)?"bg-green-100":"bg-gray-50"])},[e("p",$s,t(g.name),1),e("p",_s,t(g.tokens),1),e("p",xs,t(a.$t("game.score.tokens",{count:g.tokens})),1),e("p",ws,t(a.$t("game.score.total",{score:g.score})),1)],2)}),128))])])])):M.value==="finished"?(n(),o("div",Ts,[e("div",Ms,[e("h2",Cs,t(a.$t("game.end.title")),1),e("p",Ps,t(a.$t("game.end.winner",{player:(j=k.value)==null?void 0:j.name,score:(E=k.value)==null?void 0:E.tokens})),1),e("div",zs,[e("h3",As,t(a.$t("game.end.finalScores")),1),e("div",Bs,[(n(!0),o(F,null,I(D.value,(g,T)=>(n(),o("div",{key:g.id,class:z(["flex justify-between items-center p-3 rounded-lg",T===0?"bg-yellow-100":"bg-gray-50"])},[e("span",Ls,t(T+1)+". "+t(g.name),1),e("span",Ds,t(g.tokens)+" "+t(a.$t("game.score.tokens",{count:g.tokens})),1)],2))),128))])]),e("div",js,[e("button",{onClick:c,class:"btn btn-primary"}," 🔄 "+t(a.$t("game.end.playAgain")),1),e("button",{onClick:p[2]||(p[2]=g=>a.$router.push("/")),class:"btn btn-secondary"}," 🏠 "+t(a.$t("game.backToHome")),1)])])])):m("",!0)])])}}});export{Vs as default};
