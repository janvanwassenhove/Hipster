import{d as N,l as R,r as C,c as g,o as L,m as H,a as o,b as e,e as m,t as s,n as b,j as n,w as M,f as p,F as B,h as E,u as O,i as G,p as I}from"./index-CXY3GNxQ.js";const V={class:"card"},z={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6"},q={class:"flex-shrink-0"},J=["src","alt"],U={class:"flex-1 text-center md:text-left"},K={key:0,class:"mb-4"},Q={class:"text-gray-600"},W={class:"text-sm text-gray-500"},X={key:1,class:"mb-4"},Y={class:"text-xl font-bold text-gray-800"},Z={class:"text-lg text-gray-600"},ee={class:"text-sm text-gray-500"},te={key:2,class:"mb-4"},se={class:"text-xl font-bold text-gray-800"},ae={class:"text-lg text-gray-600"},ne={class:"text-gray-600"},re={class:"text-sm text-gray-500"},oe={class:"mb-4"},le={key:0,class:"bg-gray-100 border border-gray-300 rounded-lg p-4 text-center"},ie={class:"text-gray-600"},ce={class:"text-sm text-gray-500"},de=["src"],ue={class:"flex items-center justify-center md:justify-start space-x-4 mb-4"},me=["disabled"],ge={key:0},pe={key:1},ve=["disabled"],he={key:3,class:"p-4 bg-blue-50 border border-blue-200 rounded-lg"},ye={class:"text-center"},fe={class:"text-lg font-bold text-blue-800"},$e={class:"text-blue-700"},_e={class:"text-blue-600"},be={class:"text-sm text-blue-500 mt-2"},ke=["href"],xe={key:0,class:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg"},we={class:"text-center font-medium text-yellow-800"},Te={class:"text-center text-sm text-yellow-700 mt-1"},Pe={class:"font-bold text-lg"},De={key:0,class:"text-sm mt-1"},Ce=N({__name:"TrackPlayer",props:{track:{},difficulty:{},showAnswer:{type:Boolean,default:!1},showResult:{type:Boolean,default:!1},isCorrect:{type:Boolean,default:!1},pointsEarned:{default:0}},emits:["placeTrack"],setup(j,{emit:x}){const l=j,{t:f}=R(),d=C(),i=C(!1),h=g(()=>{var a,c,v,D;const t=(c=(a=l.track.images)==null?void 0:a[0])==null?void 0:c.url,r=(D=(v=l.track.album.images)==null?void 0:v[0])==null?void 0:D.url;return t||r||"https://via.placeholder.com/300x300/6B7280/FFFFFF?text=No+Image"}),y=g(()=>l.track.artists.map(t=>t.name).join(", ")),w=g(()=>l.showResult?l.isCorrect?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800":""),T=g(()=>l.showResult?l.isCorrect?f("game.turn.correct",{year:l.track.year}):f("game.turn.incorrect",{year:l.track.year}):"");function k(){d.value&&(i.value?d.value.pause():d.value.play())}function $(){d.value&&(d.value.currentTime=0,i.value&&d.value.play())}function P(){i.value=!1}return L(()=>{d.value&&(d.value.addEventListener("play",()=>{i.value=!0}),d.value.addEventListener("pause",()=>{i.value=!1}))}),H(()=>{d.value&&d.value.pause()}),(t,r)=>(n(),o("div",V,[e("div",z,[e("div",q,[e("img",{src:h.value,alt:t.track.name,class:"w-32 h-32 rounded-lg shadow-lg object-cover"},null,8,J)]),e("div",U,[t.difficulty==="original"?(n(),o("div",K,[e("p",Q,s(t.$t("game.turn.listening")),1),e("p",W,s(t.$t("game.difficulties.originalHint")),1)])):t.difficulty==="pro"?(n(),o("div",X,[e("h3",Y,s(t.track.name),1),e("p",Z,s(y.value),1),e("p",ee,s(t.$t("game.difficulties.proHint")),1)])):t.difficulty==="expert"?(n(),o("div",te,[e("h3",se,s(t.track.name),1),e("p",ae,s(y.value),1),e("p",ne,s(t.track.album.name),1),e("p",re,s(t.$t("game.difficulties.expertHint")),1)])):m("",!0),e("div",oe,[t.track.preview_url?(n(),o("audio",{key:1,ref_key:"audioPlayer",ref:d,src:t.track.preview_url,controls:"",class:"w-full",onEnded:P},s(t.$t("game.audioNotSupported")),41,de)):(n(),o("div",le,[e("p",ie,"🎵 "+s(t.$t("game.demoMode")),1),e("p",ce,s(t.$t("game.noPreview")),1)]))]),e("div",ue,[e("button",{onClick:k,class:"btn btn-primary",disabled:!t.track.preview_url},[i.value?(n(),o("span",ge,"⏸️ "+s(t.$t("game.pause")),1)):(n(),o("span",pe,"▶️ "+s(t.$t("game.play")),1))],8,me),e("button",{onClick:$,class:"btn btn-secondary",disabled:!t.track.preview_url}," 🔄 "+s(t.$t("game.restart")),9,ve)]),t.showAnswer?(n(),o("div",he,[e("div",ye,[e("h4",fe,s(t.track.name),1),e("p",$e,s(y.value),1),e("p",_e,s(t.track.album.name)+" ("+s(t.track.year)+")",1),e("p",be,[e("a",{href:t.track.external_urls.spotify,target:"_blank",rel:"noopener noreferrer",class:"underline hover:no-underline"},s(t.$t("game.openInSpotify"))+" ↗ ",9,ke)])])])):m("",!0)])]),t.showAnswer?m("",!0):(n(),o("div",xe,[e("p",we,s(t.$t("game.turn.placing")),1),e("p",Te,s(t.$t("game.dragToTimeline")),1)])),t.showResult?(n(),o("div",{key:1,class:b(["mt-4 p-4 rounded-lg text-center",w.value])},[e("p",Pe,s(T.value),1),t.pointsEarned>0?(n(),o("p",De,s(t.$t("game.turn.points",{points:t.pointsEarned})),1)):m("",!0)],2)):m("",!0)]))}}),je={class:"flex items-center justify-between mb-4"},Be={class:"text-lg font-semibold flex items-center space-x-2"},Ee={key:0,class:"text-green-500"},Ne={class:"text-right"},Se={class:"text-2xl font-bold"},Fe={class:"text-sm text-gray-600"},Ae={class:"mb-4"},Ie={class:"text-sm font-medium text-gray-700 mb-2"},Le={key:0,class:"text-center py-8 text-gray-500"},Re={class:"text-center text-gray-500"},He={key:1,class:"space-y-2"},Me={class:"text-center text-gray-500 text-sm"},Oe={class:"flex items-center space-x-3"},Ge=["src","alt"],Ve={class:"flex-1 min-w-0"},ze={class:"font-medium truncate"},qe={class:"text-sm text-gray-600 truncate"},Je={class:"text-right flex-shrink-0"},Ue={class:"font-bold text-lg"},Ke=["onDragover","onDragleave","onDrop"],Qe={class:"text-center text-gray-500 text-sm"},We={class:"text-center text-gray-500 text-sm"},Xe={class:"flex items-center space-x-3"},Ye=["src","alt"],Ze={class:"flex-1 min-w-0"},et={class:"font-medium text-blue-800"},tt={class:"text-sm text-blue-600"},st={key:1,class:"mt-4 pt-4 border-t border-gray-200"},at={class:"flex justify-between text-sm text-gray-600"},nt={key:0},rt=N({__name:"PlayerTimeline",props:{player:{},isCurrent:{type:Boolean},currentTrack:{},canPlace:{type:Boolean}},emits:["placeTrack"],setup(j,{emit:x}){const l=j,f=x,d=C(!1),i=C([]),h=g(()=>{if(l.player.timeline.length<2)return null;const t=l.player.timeline.map(r=>r.year).sort((r,a)=>r-a);return`${t[0]} - ${t[t.length-1]}`});function y(t){var r,a,c,v;return((a=(r=t.images)==null?void 0:r[0])==null?void 0:a.url)||((v=(c=t.album.images)==null?void 0:c[0])==null?void 0:v.url)||"/placeholder-album.png"}function w(t){return t.artists.map(r=>r.name).join(", ")}function T(t){var a;if(!l.currentTrack)return;(a=t.dataTransfer)==null||a.setData("text/plain",JSON.stringify(l.currentTrack)),t.target.classList.add("dragging")}function k(t){t.target.classList.remove("dragging"),d.value=!1,i.value=[]}function $(t){!l.currentTrack||!l.canPlace||(d.value=!1,i.value=[],f("placeTrack",l.currentTrack,t))}function P(){i.value=new Array(l.player.timeline.length+1).fill(!1)}return M(()=>l.player.timeline.length,()=>{P()},{immediate:!0}),(t,r)=>(n(),o("div",{class:b(["card",{"ring-2 ring-green-500":t.isCurrent}])},[e("div",je,[e("h3",Be,[e("span",null,s(t.player.name),1),t.isCurrent?(n(),o("span",Ee,"👑")):m("",!0)]),e("div",Ne,[e("p",Se,s(t.player.score),1),e("p",Fe,s(t.$t("game.score.tokens",{count:t.player.tokens})),1)])]),e("div",Ae,[e("h4",Ie,s(t.$t("game.timeline.title")),1),t.player.timeline.length===0?(n(),o("div",Le,[e("p",null,s(t.$t("game.timeline.empty")),1),t.canPlace?(n(),o("div",{key:0,class:b(["timeline-slot mt-4",{"drag-over":d.value}]),onDragover:r[0]||(r[0]=p(a=>d.value=!0,["prevent"])),onDragleave:r[1]||(r[1]=p(a=>d.value=!1,["prevent"])),onDrop:r[2]||(r[2]=p(a=>$(0),["prevent"]))},[e("p",Re,s(t.$t("game.timeline.placeHere")),1)],34)):m("",!0)])):(n(),o("div",He,[t.canPlace?(n(),o("div",{key:0,class:b(["timeline-slot h-16",{"drag-over":i.value[0]}]),onDragover:r[3]||(r[3]=p(a=>i.value[0]=!0,["prevent"])),onDragleave:r[4]||(r[4]=p(a=>i.value[0]=!1,["prevent"])),onDrop:r[5]||(r[5]=p(a=>$(0),["prevent"]))},[e("p",Me,s(t.$t("game.placeEarlier")),1)],34)):m("",!0),(n(!0),o(B,null,E(t.player.timeline,(a,c)=>(n(),o("div",{key:a.id,class:"track-card"},[e("div",Oe,[e("img",{src:y(a),alt:a.name,class:"w-12 h-12 rounded object-cover flex-shrink-0"},null,8,Ge),e("div",Ve,[e("p",ze,s(a.name),1),e("p",qe,s(w(a)),1)]),e("div",Je,[e("p",Ue,s(a.year),1)])]),t.canPlace&&c<t.player.timeline.length-1?(n(),o("div",{key:0,class:b(["timeline-slot h-16 mt-2",{"drag-over":i.value[c+1]}]),onDragover:p(v=>i.value[c+1]=!0,["prevent"]),onDragleave:p(v=>i.value[c+1]=!1,["prevent"]),onDrop:p(v=>$(c+1),["prevent"])},[e("p",Qe,s(t.$t("game.placeBetween")),1)],42,Ke)):m("",!0)]))),128)),t.canPlace?(n(),o("div",{key:1,class:b(["timeline-slot h-16",{"drag-over":i.value[t.player.timeline.length]}]),onDragover:r[6]||(r[6]=p(a=>i.value[t.player.timeline.length]=!0,["prevent"])),onDragleave:r[7]||(r[7]=p(a=>i.value[t.player.timeline.length]=!1,["prevent"])),onDrop:r[8]||(r[8]=p(a=>$(t.player.timeline.length),["prevent"]))},[e("p",We,s(t.$t("game.placeLater")),1)],34)):m("",!0)]))]),t.canPlace&&t.currentTrack?(n(),o("div",{key:0,class:"p-4 bg-blue-50 border-2 border-blue-200 rounded-lg cursor-move",draggable:"true",onDragstart:T,onDragend:k},[e("div",Xe,[e("img",{src:y(t.currentTrack),alt:t.currentTrack.name,class:"w-12 h-12 rounded object-cover flex-shrink-0"},null,8,Ye),e("div",Ze,[e("p",et,s(t.$t("game.newTrack")),1),e("p",tt,s(t.$t("game.dragToPlace")),1)]),r[9]||(r[9]=e("div",{class:"text-blue-500"},[e("span",{class:"text-2xl"},"🎵")],-1))])],32)):m("",!0),t.player.timeline.length>0?(n(),o("div",st,[e("div",at,[e("span",null,s(t.$t("game.tracksInTimeline",{count:t.player.timeline.length})),1),h.value?(n(),o("span",nt,s(h.value),1)):m("",!0)])])):m("",!0)],2))}}),ot={class:"min-h-screen flex flex-col"},lt={class:"bg-white/10 backdrop-blur-sm p-4"},it={class:"flex justify-between items-center"},ct={class:"flex items-center space-x-4"},dt={class:"text-white"},ut={class:"text-xl font-bold"},mt={class:"text-sm opacity-80"},gt={class:"text-white text-right"},pt={class:"text-sm opacity-80"},vt={class:"flex-1 container mx-auto px-4 py-6"},ht={key:0,class:"max-w-2xl mx-auto"},yt={class:"card text-center"},ft={class:"text-2xl font-semibold mb-4"},$t={class:"text-gray-600 mb-6"},_t={key:1,class:"space-y-6"},bt={class:"card text-center bg-green-50 border-green-200"},kt={class:"text-2xl font-bold text-green-800 mb-2"},xt={class:"text-green-700"},wt={key:0,class:"mt-4"},Tt={key:1,class:"mt-4"},Pt={class:"flex items-center justify-center space-x-2"},Dt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ct={class:"card"},jt={class:"text-lg font-semibold mb-4"},Bt={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Et={class:"font-semibold"},Nt={class:"text-2xl font-bold"},St={class:"text-sm text-gray-600"},Ft={key:2,class:"max-w-2xl mx-auto"},At={class:"card text-center"},It={class:"text-3xl font-bold mb-4 text-green-600"},Lt={class:"text-xl mb-6"},Rt={class:"mb-6"},Ht={class:"text-lg font-semibold mb-3"},Mt={class:"space-y-2"},Ot={class:"font-medium"},Gt={class:"font-bold"},Vt={class:"flex space-x-4 justify-center"},qt=N({__name:"GameView",setup(j){const x=G(),l=O(),f=C(!1),d=g(()=>l.players),i=g(()=>l.currentPlayer),h=g(()=>l.currentTrack),y=g(()=>l.gamePhase),w=g(()=>l.round),T=g(()=>l.settings),k=g(()=>l.winner),$=g(()=>[...d.value].sort((a,c)=>c.score-a.score));async function P(){f.value=!0;try{await l.getNextTrack()||console.error("No tracks available")}catch(a){console.error("Error loading track:",a)}finally{f.value=!1}}function t(a,c){l.placeTrackOnTimeline(a,c),setTimeout(()=>{l.nextPlayer()},2e3)}function r(){l.resetGame(),x.push("/")}return L(()=>{l.gamePhase==="setup"&&l.players.length===0&&x.push("/")}),(a,c)=>{var v,D,S,F;return n(),o("div",ot,[e("header",lt,[e("div",it,[e("div",ct,[e("button",{onClick:c[0]||(c[0]=u=>a.$router.push("/")),class:"btn btn-secondary"}," ← "+s(a.$t("common.back")),1),e("div",dt,[e("h1",ut,s(a.$t("game.title")),1),e("p",mt,s(a.$t("game.round"))+" "+s(w.value),1)])]),e("div",gt,[e("p",pt,s(a.$t("game.turn.currentPlayer",{player:(v=i.value)==null?void 0:v.name})),1)])])]),e("main",vt,[y.value==="setup"?(n(),o("div",ht,[e("div",yt,[e("h2",ft,s(a.$t("game.setupRequired")),1),e("p",$t,s(a.$t("game.setupMessage")),1),e("button",{onClick:c[1]||(c[1]=u=>a.$router.push("/")),class:"btn btn-primary"},s(a.$t("game.backToSetup")),1)])])):y.value==="playing"?(n(),o("div",_t,[e("div",bt,[e("h2",kt,s(a.$t("game.turn.currentPlayer",{player:(D=i.value)==null?void 0:D.name})),1),e("p",xt,s(a.$t("game.turn.ready")),1),!h.value&&!f.value?(n(),o("div",wt,[e("button",{onClick:P,class:"btn btn-primary btn-lg"}," 🎵 "+s(a.$t("game.getTrack")),1)])):m("",!0),f.value?(n(),o("div",Tt,[e("div",Pt,[c[3]||(c[3]=e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-green-500"},null,-1)),e("span",null,s(a.$t("common.loading")),1)])])):m("",!0)]),h.value?(n(),I(Ce,{key:0,track:h.value,difficulty:T.value.difficulty,onPlaceTrack:t},null,8,["track","difficulty"])):m("",!0),e("div",Dt,[(n(!0),o(B,null,E(d.value,u=>{var _,A;return n(),I(rt,{key:u.id,player:u,"is-current":u.id===((_=i.value)==null?void 0:_.id),"current-track":h.value,"can-place":u.id===((A=i.value)==null?void 0:A.id)&&!!h.value,onPlaceTrack:t},null,8,["player","is-current","current-track","can-place"])}),128))]),e("div",Ct,[e("h3",jt,s(a.$t("game.score.title")),1),e("div",Bt,[(n(!0),o(B,null,E(d.value,u=>{var _;return n(),o("div",{key:u.id,class:b(["text-center p-3 rounded-lg",u.id===((_=i.value)==null?void 0:_.id)?"bg-green-100":"bg-gray-50"])},[e("p",Et,s(u.name),1),e("p",Nt,s(u.score),1),e("p",St,s(a.$t("game.score.tokens",{count:u.tokens})),1)],2)}),128))])])])):y.value==="finished"?(n(),o("div",Ft,[e("div",At,[e("h2",It,s(a.$t("game.end.title")),1),e("p",Lt,s(a.$t("game.end.winner",{player:(S=k.value)==null?void 0:S.name,score:(F=k.value)==null?void 0:F.score})),1),e("div",Rt,[e("h3",Ht,s(a.$t("game.end.finalScores")),1),e("div",Mt,[(n(!0),o(B,null,E($.value,(u,_)=>(n(),o("div",{key:u.id,class:b(["flex justify-between items-center p-3 rounded-lg",_===0?"bg-yellow-100":"bg-gray-50"])},[e("span",Ot,s(_+1)+". "+s(u.name),1),e("span",Gt,s(u.score)+" "+s(a.$t("game.points")),1)],2))),128))])]),e("div",Vt,[e("button",{onClick:r,class:"btn btn-primary"}," 🔄 "+s(a.$t("game.end.playAgain")),1),e("button",{onClick:c[2]||(c[2]=u=>a.$router.push("/")),class:"btn btn-secondary"}," 🏠 "+s(a.$t("game.backToHome")),1)])])])):m("",!0)])])}}});export{qt as default};
